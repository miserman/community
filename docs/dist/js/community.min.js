!function(){const e=function(e,t,i){"use strict";Object.hasOwn||Object.defineProperty(Object,"hasOwn",{value:function(e,t){if(null==e)throw new TypeError("Cannot convert undefined or null to object");return Object.prototype.hasOwnProperty.call(Object(e),t)},configurable:!0,enumerable:!1,writable:!0});const a={rdylbu7:{name:"Red-Yellow-Blue (7)",type:"discrete",colors:["#d73027","#fc8d59","#fee090","#adadad","#e0f3f8","#91bfdb","#4575b4"]},orrd7:{name:"Orange-Red (7)",type:"discrete",colors:["#fef0d9","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#990000"]},gnbu7:{name:"Green-Blue (7)",type:"discrete",colors:["#a8ddb5","#ccebc5","#f0f9e8","#adadad","#4eb3d3","#2b8cbe","#08589e"]},brbg7:{name:"Brown-Teal (7)",type:"discrete",colors:["#8c510a","#d8b365","#f6e8c3","#adadad","#c7eae5","#5ab4ac","#01665e"]},puor7:{name:"Purple-Orange (7)",type:"discrete",colors:["#b35806","#f1a340","#fee0b6","#adadad","#d8daeb","#998ec3","#542788"]},prgn6:{name:"Purple-Green (6)",type:"discrete",colors:["#762a83","#af8dc3","#e7d4e8","#d9f0d3","#7fbf7b","#1b7837"]},reds5:{name:"Red (5)",type:"discrete",colors:["#f1eef6","#d7b5d8","#df65b0","#dd1c77","#980043"]},greens5:{name:"Green (5)",type:"discrete",colors:["#ffffcc","#c2e699","#78c679","#31a354","#006837"]},paired4:{name:"Blue-Green (4)",type:"discrete",colors:["#1f78b4","#a6cee3","#b2df8a","#33a02c"]},greys4:{name:"Grey (4)",type:"discrete",colors:["#f7f7f7","#cccccc","#969696","#525252"]},grey:{name:"Grey",type:"continuous",colors:[[[70,70,70],[80,80,80]],[150,150,150],[[230,230,230],[-80,-80,-80]]]},brown:{name:"Brown",type:"continuous",colors:[[[131,30,0],[62,85,95]],[193,115,95],[[255,200,190],[-62,-85,-95]]]},purple:{name:"Purple",type:"continuous",colors:[[[90,14,213],[52.5,89,16]],[142.5,103,229],[[195,192,245],[-52.5,-89,-16]]]},prgn:{name:"Purple-Green",type:"continuous-divergent",colors:[[[27,120,55],[207,107,168.5]],[234,227,223.5],[[118,42,131],[116,185,92.5]]]},puor:{name:"Purple-Orange",type:"continuous-divergent",colors:[[[179,88,6],[56,133,202.5]],[235,221,208.5],[[84,39,136],[151,182,72.5]]]},rdbu:{name:"Red-Blue",type:"continuous-divergent",colors:[[[69,117,180],[170,116.5,16]],[239,233.5,196],[[215,48,39],[24,185.5,157]]]},vik:{name:"vik",type:"continuous-polynomial",colors:[[97.031,18.4251,.4149],[461.7602,637.5326,244.4647],[-2434.798,-2838.5427,-5893.4695],[9665.3469,14405.823,44072.722],[-2575.9109,-25871.106,-109792.1319],[-42510.0569,8528.3288,120953.8594],[63342.3061,14006.291,-59644.4457],[-26045.0391,-8868.9621,10155.5667]]},lajolla:{name:"lajolla",type:"continuous-polynomial",colors:[[256.0016,255.9138,204.945],[-187.6735,-46.2889,-768.5655],[1022.785,-1057.5602,1782.0325],[-2032.382,1490.8271,-1785.9056],[966.8373,-617.1949,567.7715]]}},s={seps:/[\s._-]/g,period:/\./,all_periods:/\./g,word_start:/\b(\w)/g,settings:/^settings\./,features:/^features\./,filter:/^filter\./,data:/^data\./,variables:/^variables\./,palette:/^pal/,datasets:/^dat/,variable:/^var/,levels:/^lev/,ids:/^ids/,minmax:/^m[inax]{2}$/,int_types:/^(?:year|integer)$/,end_punct:/[.?!]$/,mustache:/\{(.*?)\}/g,measure_name:/(?:^measure|_name)$/,http:/^https?:\/\//,bool:/^(?:true|false)$/,number:/^[\d-][\d.,]*$/,leading_zeros:/^0+/,url_spaces:/%20/g,hashes:/#/g,embed_setting:/^(?:hide_|navcolor|close_menus)/,median:/^med/i,location_string:/^[^?]*/},n="button.has-note::after,.button-wrapper.has-note button::before,.has-note legend::before,.has-note label::before,.wrapper.has-note > div > label::before{display:none}",r={setting:function(a){var s,r,l=a.value(),d=l?"dark":"light";if(l!==i.settings[a.setting]){if(i.settings[a.setting]=l,"theme_dark"===a.setting){if(l?t.body.classList.replace("light-theme","dark-theme"):t.body.classList.replace("dark-theme","light-theme"),i.plotly)for(s in i.plotly)Object.hasOwn(i.plotly,s)&&B(i.plotly[s].u);if(i.map)for(s in i.map)if(Object.hasOwn(i.map,s)&&i.map[s].u&&Object.hasOwn(i.map[s].u.tiles,d)){for(r in i.map[s].u.tiles)d!==r&&Object.hasOwn(i.map[s].u.tiles,r)&&i.map[s].u.tiles[r].removeFrom(i.map[s].u.map);i.map[s].u.tiles[d].addTo(i.map[s].u.map)}}else"hide_url_parameters"===a.setting?e.history.replaceState(Date.now(),"",i.settings.hide_url_parameters?e.location.protocol+"//"+e.location.host+e.location.pathname:U()):"hide_tooltips"===a.setting?l?h.script_style.sheet.insertRule(n,0):h.script_style.sheet.removeRule(0):"map_overlay"===a.setting?Object.keys(i.map).forEach((e=>{"_"!==e[0]&&(l?i.map[e].u.update():(i.map[e].u.overlay.clearLayers(),i.map[e].u.overlay_control.remove()))})):ne();o.setItem(a.setting,i.settings[a.setting])}},options:function(e,t){var a,n,r,l,d,o=0,h=e.dataset?X(e.dataset):e.view?v[e.view].get.dataset():X(t.dataset)||p.dataset,c=X(e.variable);if(Object.hasOwn(e,"option_sets")||(e.option_sets={}),e.e.innerHTML="",t&&Object.hasOwn(e.option_sets,d=h+(c||""))){if(e.values=e.option_sets[d].values,e.display=e.option_sets[d].display,!e.view||"ID"!==e.variable&&"ids"!==e.options_source)for(l=(r=e.option_sets[d].options).length,n=0;n<l;n++)e.e.appendChild(r[n]),o++;else for(a=i.dataviews[e.view].selection.all,l=(r=e.option_sets[d].options).length,o=0,n=0;n<l;n++)e.e.appendChild(r[n]),Object.hasOwn(a,r[n].value)?(r[n].classList.remove("hidden"),o++):r[n].classList.add("hidden");e.e[o?"removeAttribute":"setAttribute"]("disabled",!0)}else s.variable.test(e.options_source)?(h=t.value())&&x(e,h,e.option_sets):s.levels.test(e.options_source)?j(e,h,c,e.option_sets):s.ids.test(e.options_source)&&C(e,h,e.option_sets);e.set(e.value())},min:function(e,t){var a,n=t.value(),l=e.value(),d=v[e.view||t.view];s.minmax.test(n)&&(n=t.parsed.min),d&&d.y&&(a=X(d.y),Object.hasOwn(i.data.variables,a)&&(d.time_range.time.length||r.time_range(d,e,!0),n=Math.max(d.time_range.time[0],parseFloat(n))),e.update()),e.e.min=void 0===e.parsed.min?parseFloat(n):Math.max(e.parsed.min,parseFloat(n)),e.e.value?"number"==typeof l&&isFinite(l)&&l<n&&e.set(n):e.reset()},max:function(e,t){var a,n=t.value(),l=e.value(),d=v[e.view||t.view];s.minmax.test(n)&&(n=t.parsed.max),d&&d.y&&(a=X(d.y),Object.hasOwn(i.data.variables,a)&&(d.time_range.time.length||r.time_range(d,e,!0),n=Math.min(d.time_range.time[1],parseFloat(n))),e.update()),e.e.max=void 0===e.parsed.max?parseFloat(n):Math.min(e.parsed.max,parseFloat(n)),e.e.value?"number"==typeof l&&isFinite(l)&&l>n&&e.set(n):e.reset()},dataview:function(e){if((e=e||v[p.dataview]).value()!==e.state){var t,a="",s=i.settings.summary_selection;i.data.inited[e.parsed.dataset]?(e.valid=!0,e.n_selected.ids=0,e.n_selected.children=0,e.n_selected.features=0,e.n_selected.variables=0,e.n_selected.dataset=0,e.n_selected.filtered=0,e.n_selected.all=0,e.selection.ids={},e.selection.children={},e.selection.features={},e.selection.variables={},e.selection.dataset={},e.selection.filtered={},e.selection.all={},Object.keys(i.data.entities).forEach((n=>{(t=e.check(i.data.entities[n])).all=0,t.ids&&(e.selection.ids[n]=i.data.entities[n],e.n_selected.ids++,t.all++),t.features&&(e.selection.features[n]=i.data.entities[n],e.n_selected.features++,t.all++),t.variables&&(e.selection.variables[n]=i.data.entities[n],e.n_selected.variables++,t.all++),t.dataset&&(e.selection.dataset[n]=i.data.entities[n],e.n_selected.dataset++,t.all++),t.dataset&&t.ids&&(e.selection.children[n]=i.data.entities[n],e.n_selected.children++),t.features&&t.dataset&&(e.selection.filtered[n]=i.data.entities[n],e.n_selected.filtered++),4===t.all&&(a||(a=n),e.selection.all[n]=i.data.entities[n],e.n_selected.all++,s+=n)})),a&&s!==e.summary_state&&(e.summary_state=s,Object.keys(i.data.variables).forEach((t=>{t!==i.data.meta.times[e.parsed.dataset].name&&Object.hasOwn(i.data.variables,t)&&Object.hasOwn(i.data.variables[t].time_range,e.parsed.dataset)&&i.data.calculate_summary(t,e.id,!0)})),A(e.id,"update")),le(e.id)):(e.valid=!1,i.data.data_queue[e.parsed.dataset][e.id]=function(){return r.dataview(e)},i.data.loaded[e.parsed.dataset]&&i.data.load_id_maps())}},time_filters:function(e){e.time_range.filtered[0]=1/0,e.time_range.filtered[1]=-1/0;const t=e.get.dataset(),a=i.data.meta.times[t],s=g[e.id+"_filter"];if(i.data.inited[t]){for(var n,l,d={},o=a.n;o--;){if(o>=e.time_range.index[0]&&o<=e.time_range.index[1])for(n=e.time_filters.length,l=!1;n--&&(Object.hasOwn(d,e.time_filters[n].value)||(d[e.time_filters[n].value]=X(e.time_filters[n].value)),l=DataHandler.prototype.checks[e.time_filters[n].type](a.value[o],d[e.time_filters[n].value])););else l=!1;e.times[o]=l,l&&(e.time_range.filtered[0]>a.value[o]&&(e.time_range.filtered[0]=a.value[o]),e.time_range.filtered[1]<a.value[o]&&(e.time_range.filtered[1]=a.value[o]))}if(e.time_range.filtered_index=[e.time_range.index[0]+e.time_range.filtered[0]-e.time_range.time[0],e.time_range.index[1]+e.time_range.filtered[1]-e.time_range.time[1]],s)for(o=s.length;o--;)"update"===s[o].type?v[s[o].id].update():Object.hasOwn(r,s[o].type)&&r[s[o].type](v[s[o].id],e)}},time_range:function(e,t,a){const s=t&&t.value(),n=e.get.dataset(),d=e.time?X(e.time):p.time,o=Object.hasOwn(i.data.variables,d)?i.data.variables[d].info[n].min:"",h=g[e.id+"_time"],c=Object.hasOwn(i.data.variables,s)?s:X(e.y);if(i.data.inited[n]){var m,f,b=i.data.variables[c];if(b){if(!Object.hasOwn(b,e.id))return i.data.init_summaries().then((function(){l.dataview.time_range(e,t,a)}));if(-1!==(b=b.time_range[n])[0]&&(e.time_range.variable=c,e.time_range.index[0]=b[0],e.time_range.time[0]=e.time_range.filtered[0]=o+b[0],e.time_range.index[1]=b[1],e.time_range.time[1]=e.time_range.filtered[1]=o+b[1]),!a&&h){for(m=h.length;m--;)f=v[h[m].id].value(),"min"===h[m].type?isFinite(e.time_range.time[0])&&parseFloat(v[h[m].id].e.min)!==e.time_range.time[0]&&(v[h[m].id].e.min=e.time_range.time[0],(!u.retain_state||e.time_range.time[0]>f)&&v[h[m].id].set(e.time_range.time[0])):"max"===h[m].type&&isFinite(e.time_range.time[1])&&parseFloat(v[h[m].id].e.max)!==e.time_range.time[1]&&(v[h[m].id].e.max=e.time_range.time[1],(!u.retain_state||e.time_range.time[1]<f||f<e.time_range.time[0])&&v[h[m].id].set(e.time_range.time[1]));r.time_filters(e)}}}}},l={button:{init:function(t){t.target=t.e.getAttribute("target"),"copy"===t.target&&(t.settings.endpoint=i.endpoint),"filter"===t.target&&(t.e.setAttribute("data-bs-toggle","modal"),t.e.setAttribute("data-bs-target","#filter_display")),t.e.addEventListener("click",t.settings.effects?"filter"===t.target?se:"export"===t.target||"copy"===t.target?function(a){const s={},n=this.settings,r=v[n.dataview],l=r&&r.parsed.dataset;for(var d in n.query)Object.hasOwn(n.query,d)&&(s[d]=X(n.query[d]));if(Object.hasOwn(v,n.dataview)&&(!Object.hasOwn(s,"include")&&r.y&&(s.include=X(r.y)),!Object.hasOwn(s,"id")&&r.ids&&(s.id=X(r.ids))),"copy"===this.target||this.api){var o=[];Object.hasOwn(s,"include")&&o.push("include="+s.include),Object.hasOwn(s,"dataset")&&o.push("dataset="+s.dataset),Object.hasOwn(s,"id")&&o.push("id="+s.id),r&&(s.time_range||o.push("time_range="+i.data.meta.times[l].value[r.time_range.filtered_index[0]]+","+i.data.meta.times[l].value[r.time_range.filtered_index[1]]),r.features&&Object.keys(r.features).forEach((e=>{Object.hasOwn(s,e)||(s[e]=X(r.features[e]),Array.isArray(s[e])&&(s[e]=s[e].join(",")),o.push(e+"="+s[e]))})),i.data.filter&&i.data.filter.forEach((e=>{const t=Number(e.value);isNaN(t)||o.push(e.variable+e.operator+t)}))),d=n.endpoint+(o.length?"?"+o.join("&"):""),this.api?e.location.href=d:navigator.clipboard.writeText(d).then((()=>{"Copied!"!==t.e.innerText&&(t.text=t.e.innerText,t.e.innerText="Copied!",setTimeout((function(){t.e.innerText=t.text}),500))}),(e=>{e!==t.e.innerText&&(t.text=t.e.innerText,t.e.innerText=e,setTimeout((function(){t.e.innerText=t.text}),1500))}))}else r&&Object.hasOwn(r,"selection")?(s.time_range||(s.time_range=i.data.meta.times[l].value[r.time_range.filtered_index[0]]+","+i.data.meta.times[l].value[r.time_range.filtered_index[1]]),i.data.export(s,r.selection.all,!0)):i.data.export(s,i.data.entities,!0)}.bind(t):function(){for(var e in this.settings.effects)Object.hasOwn(v,e)&&(""===this.settings.effects[e]||-1==this.settings.effects[e]?v[e].reset():v[e].set(this.settings.effects[e]))}.bind(t):"refresh"===t.target?ne:"reset_selection"===t.target?re:"reset_storage"===t.target?ae:function(){Object.hasOwn(v,this.target)&&v[this.target].reset()}.bind(t))}},buttongroup:{retrieve:function(){for(var e=this.options.length;e--;)if(this.options[e].checked){this.set(e);break}},setter:function(e){this.previous=this.value(),this.current_index="string"==typeof e?this.values.indexOf(e):e,-1!==this.current_index?(this.source=Object.hasOwn(v,this.values[this.current_index])?v[this.values[this.current_index]]:this.values[this.current_index],this.options[this.current_index].checked=!0):this.source=void 0,le(this.id)},listener:function(e){this.set(e.target.value)},adder:function(e,i,a){var s=[t.createElement("input"),t.createElement("label")];return s[0].className="btn-check",s[0].type="radio",s[0].name=this.e.id+"_options",s[0].autocomplete="off",s[0].value=i,s[0].id=this.e.id+"_option"+e,s[1].className="btn btn-primary",s[1].innerText=a,s[1].setAttribute("for",s[0].id),this.e.appendChild(s[0]),this.e.appendChild(s[1]),s}},radio:{retrieve:function(){for(var e=this.options.length;e--;)if(this.options[e].checked){this.set(e);break}},setter:function(e){this.current_index="string"==typeof e?this.values.indexOf(e):e,-1!==this.current_index?(this.source=Object.hasOwn(v,this.values[this.current_index])?v[this.values[this.current_index]]:this.values[this.current_index],this.options[this.current_index].checked=!0):this.source=void 0,le(this.id)},listener:function(e){this.set(e.target.value)},adder:function(e,i){var a=t.createElement("div");return this.e.appendChild(a),a.className="form-check",a.appendChild(t.createElement("input")),a.appendChild(t.createElement("label")),a.firstElementChild.class="form-check-input",a.firstElementChild.type="radio",a.firstElementChild.name=this.e.id+"_options",a.firstElementChild.id=this.e.id+"_option"+this.e.childElementCount,a.firstElementChild.value=e,a.lastElementChild.innerText=i,a.lastElementChild.className="form-check-label",a.lastElementChild.setAttribute("for",a.firstElementChild.id),this.e}},checkbox:{retrieve:function(){this.source=[],this.current_index=[];for(var e=this.options.length;e--;)this.options[e].checked&&(this.source.push(this.values[e]),this.current_index.push(e));le(this.id)},setter:function(e){if("object"==typeof e){this.source=[],this.current_index=[];for(var t=this.values.length;t--;)-1!==e.indexOf(this.values[t])?(this.source.push(this.values[t]),this.current_index.push(t),this.options[t].checked=!0):this.options[t].checked=!1}else{if("string"==typeof e)return this.set(e.split(","));-1!==e&&(this.options[e].checked=!0)}le(this.id)},listener:function(e){if(e.target.checked)this.source.push(e.target.value),this.current_index.push(this.values.indexOf(e.target.value));else{var t=this.source.indexOf(e.target.value);-1!==t&&(this.source.splice(t,1),this.current_index.splice(t,1))}le(this.id)},adder:function(e,i){var a=t.createElement("div");return this.e.appendChild(a),a.className="form-check",a.appendChild(t.createElement("input")),a.appendChild(t.createElement("label")),a.firstElementChild.class="form-check-input",a.firstElementChild.type="checkbox",a.firstElementChild.name=this.e.id+"_options",a.firstElementChild.id=this.e.id+"_option"+this.e.childElementCount,a.firstElementChild.value=e,a.lastElementChild.innerText=i,a.lastElementChild.className="form-check-label",a.lastElementChild.setAttribute("for",a.firstElementChild.id),this.e}},switch:{retrieve:function(){this.set(this.e.checked)},setter:function(e){"string"==typeof e&&(e="on"===e),e!==this.source&&(this.previous=this.e.checked,this.e.checked=this.source=e,le(this.id))},listener:function(e){this.set(e.target.checked)}},number:{init:function(e){e.e.previousElementSibling&&e.e.previousElementSibling.classList.contains("number-down")&&(e.e.previousElementSibling.addEventListener("click",function(){this.set(Math.max(this.parsed.min,this.value()-1))}.bind(e)),e.e.parentElement.lastElementChild.addEventListener("click",function(){this.set(Math.min(this.parsed.max,this.value()+1))}.bind(e)))},retrieve:function(){this.set(this.e.value)},setter:function(e){e||(e=null),"string"==typeof e&&(e=parseFloat(e)),isFinite(e)&&e!==this.source&&(this.previous=parseFloat(this.e.value),this.e.value=this.source=e,this.current_index=e-this.parsed.min,"range"===this.e.type&&(this.e.nextElementSibling.firstElementChild.innerText=this.e.value),le(this.id))},listener:function(e){this.set(e.target.value)}},text:{init:function(e){if(i.text&&Object.hasOwn(i.text,e.id)){e.text=i.text[e.id].text,e.condition=i.text[e.id].condition||[],e.depends={};for(var a,s,n,r=e.text.length,d=0;d<r;d++)if(Object.hasOwn(e.text[d],"text"))E(e,e.text[d]),e.e.appendChild(e.text[d].parts);else for(e.e.appendChild(t.createElement("span")),a=e.text[d].length,s=0;s<a;s++)E(e,e.text[d][s]);for(d=e.condition.length;d--;)Object.hasOwn(v,e.condition[d].id)&&T(e.condition[d].id,{type:"display",id:e.id});for(n in e.depends)Object.hasOwn(v,n)&&T(n,{type:"update",id:e.id});e.update=l.text.update.bind(e)}e.update()},update:function(){var e,t,a,s,n,r,l,d;for(e in this.reference_options)Object.hasOwn(this.reference_options,e)&&(this.options[e]=X(this.reference_options[e]));for(e in this.depends)Object.hasOwn(this.depends,e)&&(this.depends[e]=X(e),Object.hasOwn(i.data.entities,this.depends[e])&&(this.depends[e]=i.data.entities[this.depends[e]].features.name));for(t=this.text.length;t--;){if(l=!0,(a=this.text[t]).length){for(s=a.length;s--;)if(Object.hasOwn(a[s],"condition")){for(n=a[s].condition.length;n--&&(l=a[s].condition[n].check()););if(l){a=a[s];break}}}else if(Object.hasOwn(a,"condition"))for(s=a.condition.length;s--&&(l=a.condition[s].check()););if(l){for(s=a.text.length;s--;){if("object"==typeof(e=a.text[s]))for(d=e.length;d--;)("default"===e[d].id||DataHandler.prototype.checks[e[d].type](X(e[d].id),X(e[d].value)))&&(e=e[d].text);if(Object.hasOwn(this.depends,e))a.parts.children[s].innerText=this.depends[e];else if(Object.hasOwn(a.button,e)){for(r="",d=a.button[e].text.length;d--;)r=(Object.hasOwn(this.depends,a.button[e].text[d])?this.depends[a.button[e].text[d]]:a.button[e].text[d])+r;a.parts.children[s].innerText=r}else a.parts.children[s].innerText=e}this.text[t].length?(this.e.children[t].innerHTML="",this.e.children[t].appendChild(a.parts)):a.parts.classList.remove("hidden")}else a.parts.classList.add("hidden")}}},select:{retrieve:function(){this.set(this.e.selectedIndex)},setter:function(e){"string"==typeof e&&(e=this.values.indexOf(e)),void 0===e&&(e=-1),e===this.e.selectedIndex&&this.values[e]===this.source||(this.e.selectedIndex=e,this.source=this.values[e],le(this.id))},listener:function(e){this.set(e.target.selectedIndex)},adder:function(e,i,a){var s=t.createElement("option");return s.value=e,s.innerText=i,a&&a.info&&(s.title=a.info.description||a.info.short_description),this.e.appendChild(s),s}},plotly:{init:function(e){if(Object.hasOwn(i.plotly,e.id)){var a,n,r,l,d,o,h;for(e.x=e.e.getAttribute("x"),e.y=e.e.getAttribute("y"),e.color=e.e.getAttribute("color"),e.time=e.e.getAttribute("color-time"),e.click=e.e.getAttribute("click"),Object.hasOwn(v,e.click)&&(e.clickto=v[e.click]),e.parsed={},e.traces={},e.tab="tabpanel"===e.e.parentElement.getAttribute("role")?e.e.parentElement:void 0,e.tab&&t.getElementById(e.e.parentElement.getAttribute("aria-labelledby")).addEventListener("click",function(){e.e.parentElement.classList.contains("active")||(setTimeout(this.update,155),setTimeout(V,155))}.bind(e)),e.show=function(e){var t=I(this,e,0,0,"hover_line",p["border_highlight_"+i.settings.theme_dark]);t&&(t.line.width=4,t.marker.size=12,Plotly.addTraces(this.e,t,this.e.data.length))},e.revert=function(){this.e.data.length&&"hover_line"===this.e.data[this.e.data.length-1].name&&Plotly.deleteTraces(this.e,this.e.data.length-1)},e.options&&(i.plotly[e.id].u=e),a=i.plotly[e.id].data.length;a--;){for(r in n=i.plotly[e.id].data[a])if(Object.hasOwn(n,r)&&s.period.test(r))for(o=(d=r.split(".")).length,h=0,l=!1;h<o;h++)l=l?l[d[h]]=h===o-1?n[r]:{}:n[d[h]]={};Object.hasOwn(n,"textfont")||(n.textfont={}),Object.hasOwn(n.textfont,"color")||(n.textfont.color=p.background_highlight),Object.hasOwn(n,"line")||(n.line={}),Object.hasOwn(n.line,"color")||(n.line.color=p.background_highlight),Object.hasOwn(n,"marker")||(n.marker={}),n.marker.size=8,Object.hasOwn(n.marker,"color")||(n.marker.color=p.background_highlight),Object.hasOwn(n.marker,"line")||(n.marker.line={}),Object.hasOwn(n.marker.line,"color")||(n.marker.line.color=p.background_highlight),Object.hasOwn(n,"text")||(n.text=[]),Object.hasOwn(n,"x")||(n.x=[]),"box"===n.type?n.hoverinfo="none":Object.hasOwn(n,"y")||(n.y=[]),e.traces[i.plotly[e.id].data[a].type]=JSON.stringify(n),a||(e.base_trace=n.type,Object.hasOwn(v,e.base_trace)&&T(e.base_trace,{type:"update",id:e.id}))}Object.hasOwn(i.data.variables,e.x)||T(e.x,{type:"update",id:e.id}),Object.hasOwn(i.data.variables,e.y)||T(e.y,{type:"update",id:e.id}),Object.hasOwn(v,e.time)&&T(e.time,{type:"update",id:e.id}),e.view?(g[e.view].push({type:"update",id:e.id}),g[e.view+"_filter"].push({type:"update",id:e.id}),Object.hasOwn(v,v[e.view].time_agg)&&T(v[e.view].time_agg,{type:"update",id:e.id})):e.view=p.dataview,he.bind(e)()}},mouseover:function(e){e.points&&1===e.points.length&&this.e.data[e.points[0].fullData.index]&&(this.e.data[e.points[0].fullData.index].line.width=4,Plotly.react(this.e,this.e.data,this.e.layout),A(this.id,"show",i.data.entities[e.points[0].data.id]))},mouseout:function(e){e.points&&1===e.points.length&&this.e.data[e.points[0].fullData.index]&&(this.e.data[e.points[0].fullData.index].line.width=2,Plotly.react(this.e,this.e.data,this.e.layout),A(this.id,"revert",i.data.entities[e.points[0].data.id]))},click:function(e){this.clickto&&this.clickto.set(e.points[0].data.id)},update:function(e){if(clearTimeout(this.queue),e){if(this.e.layout){const e=v[this.view],m=e.selection&&e.selection.all,u=e.get.dataset(),f=v[this.time||e.time_agg],b="all"===i.settings.summary_selection||"children"===i.settings.summary_selection?"subset_rank":"rank";if(i.data.inited[u]&&m&&e.state){this.parsed.base_trace=X(this.base_trace),this.parsed.x=X(this.x),this.parsed.x_range=i.data.variables[this.parsed.x].time_range[u],this.parsed.y=X(this.y),this.parsed.y_range=i.data.variables[this.parsed.y].time_range[u],this.parsed.view=e,this.parsed.dataset=u,this.parsed.palette=X(e.palette)||i.settings.palette,Object.hasOwn(a,this.parsed.palette)||(this.parsed.palette=p.palette),this.parsed.color=X(this.color||e.y||this.parsed.y),this.parsed.time=(f?f.value()-i.data.meta.times[u].range[0]:0)-i.data.variables[this.parsed.color].time_range[u][0],this.parsed.summary=i.data.variables[this.parsed.color][this.view].summaries[u];const v=i.data.variables[this.parsed.y][this.view].summaries[u],g=this.parsed.summary.n[this.parsed.time]!==e.n_selected.all?i.data.variables[this.parsed.color][this.view].order[u][this.parsed.time]:i.data.variables[this.parsed.color].info[u].order[this.parsed.time];var t,s,n,r=this.parsed.summary.missing[this.parsed.time],l=this.parsed.summary.n[this.parsed.time]-1,d=g?g.length:0,o=[],h=i.settings.trace_limit||0,c=e.value()+e.get.time_filters()+u+this.parsed.x+this.parsed.y+this.parsed.palette+this.parsed.color+i.settings.summary_selection+i.settings.color_scale_center+i.settings.color_by_order+i.settings.trace_limit;for(t in h=n=h&&h<l?Math.ceil(Math.min(h/2,l/2)):0,this.reference_options)Object.hasOwn(this.reference_options,t)&&(this.options[t]=X(this.reference_options[t]));for(;r<d&&(!Object.hasOwn(m,g[r][0])||(c+=t=g[r][0],o.push(I(this,m[t],m[t][this.view][b][this.parsed.color][this.parsed.time]-this.parsed.summary.missing[this.parsed.time],l)),!h||--n));r++);if(h&&r<d)for(n=r,r=d-1;r>n&&(!Object.hasOwn(m,g[r][0])||(c+=t=g[r][0],o.push(I(this,m[t],m[t][this.view][b][this.parsed.color][this.parsed.time]-this.parsed.summary.missing[this.parsed.time],l)),--h));r--);if(c+=o.length&&o[0].type,i.settings.boxplots&&Object.hasOwn(this.traces,"box")&&m[t]){if(c+="box"+i.settings.iqr_box,o.push(s=JSON.parse(this.traces.box)),s.line.color=p.border,s.median=v.median,s.q3=v.q3,s.q1=v.q1,i.settings.iqr_box)for(s.upperfence=[],s.lowerfence=[],r=s.q1.length;r--;)l=1.5*(s.q3[r]-s.q1[r]),s.q3[r]=Math.max(s.median[r],s.q3[r]),s.upperfence[r]=s.q3[r]+l,s.q1[r]=Math.min(s.median[r],s.q1[r]),s.lowerfence[r]=s.q1[r]-l;else s.upperfence=v.max,s.lowerfence=v.min;for(s.x=[],r=s.q1.length;r--;)s.x[r]=m[t].get_value(this.parsed.x,r+this.parsed.y_range[0])}if(c!==this.state){for("boolean"!=typeof this.e.layout.yaxis.title&&(this.e.layout.yaxis.title=i.data.format_label(this.parsed.y)+(i.settings.trace_limit<e.n_selected.all?" ("+i.settings.trace_limit+" extremes)":"")),"boolean"!=typeof this.e.layout.xaxis.title&&(this.e.layout.xaxis.title=i.data.format_label(this.parsed.x)),this.e.layout.yaxis.autorange=!1,this.e.layout.yaxis.range=[1/0,-1/0],s||(s={upperfence:v.max,lowerfence:v.min}),r=0,l=v.min.length;r<l;r++)h=Math.min(s.lowerfence[r],v.min[r]),this.e.layout.yaxis.range[0]>h&&(this.e.layout.yaxis.range[0]=h),h=Math.max(s.upperfence[r],v.max[r]),this.e.layout.yaxis.range[1]<h&&(this.e.layout.yaxis.range[1]=h);h=(this.e.layout.yaxis.range[1]-this.e.layout.yaxis.range[0])/10,this.e.layout.yaxis.range[0]-=h,this.e.layout.yaxis.range[1]+=h,i.data.variables[this.parsed.x].is_time&&(this.e.layout.xaxis.autorange?(this.e.layout.xaxis.autorange=!1,this.e.layout.xaxis.type="linear",this.e.layout.xaxis.dtick=1,this.e.layout.xaxis.range=[e.time_range.filtered[0]-.5,e.time_range.filtered[1]+.5]):(this.e.layout.xaxis.range[0]=e.time_range.filtered[0]-.5,this.e.layout.xaxis.range[1]=e.time_range.filtered[1]+.5)),Plotly.react(this.e,o,this.e.layout),setTimeout(V,300),this.state=c}}}}else this.tab&&!this.tab.classList.contains("show")||(this.queue=setTimeout((()=>this.update(!0)),50))}},map:{init:function(e){e.color=e.e.getAttribute("color"),e.time=e.e.getAttribute("color-time"),e.click=e.e.getAttribute("click"),e.click&&Object.hasOwn(v,e.click)&&(e.clickto=v[e.click]),e.parsed={},e.tab="tabpanel"===e.e.parentElement.getAttribute("role")?e.e.parentElement:void 0,e.show=function(t){if(t.layer&&t.layer[this.id])if(i.data.inited[this.parsed.dataset+e.id])t.layer[this.id].setStyle({color:p["border_highlight_"+i.settings.theme_dark]});else{const e=i.map[this.id].match_time(i.data.meta.overall.value[i.data.variables[this.parsed.color].time_range[this.parsed.dataset][0]+this.parsed.time]);t.layer[this.id][e]&&t.layer[this.id][e].setStyle({color:p["border_highlight_"+i.settings.theme_dark]})}},e.revert=function(e){if(e.layer&&e.layer[this.id])if(i.data.inited[this.parsed.dataset+this.id])e.layer[this.id].setStyle({color:p.border});else{const t=i.map[this.id].match_time(i.data.meta.overall.value[i.data.variables[this.parsed.color].time_range[this.parsed.dataset][0]+this.parsed.time]);e.layer[this.id][t]&&e.layer[this.id][t].setStyle({color:p.border})}},e.view?(T(e.view,{type:"update",id:e.id}),Object.hasOwn(v,v[e.view].time_agg)&&T(v[e.view].time_agg,{type:"update",id:e.id}),v[e.view].y&&T(v[e.view].y,{type:"update",id:e.id})):e.view=p.dataview,g[e.view].push({type:"update",id:e.id}),Object.hasOwn(v,e.color)&&T(e.color,{type:"update",id:e.id}),e.time&&T(e.time,{type:"update",id:e.id}),e.e.style.height||(e.e.style.height=e.options.height?e.options.height:"400px"),ce.bind(e)()},mouseover:function(e){e.target.setStyle({color:p["border_highlight_"+i.settings.theme_dark]}),A(this.id,"show",i.data.entities[e.target.feature.properties[e.target.source.id_property]])},mouseout:function(e){A(this.id,"revert",i.data.entities[e.target.feature.properties[e.target.source.id_property]]),e.target.setStyle({color:p.border})},click:function(e){this.clickto&&this.clickto.set(e.target.feature.properties[e.target.source.id_property])},update:function(e,t,s){if(clearTimeout(this.queue),s){if(this.view&&this.displaying){const e=i.dataviews[this.view],t=e.get.dataset(),s=X(e.time_agg),h=i.map[this.id].has_time?i.map[this.id].match_time(s):s,c=Object.hasOwn(i.data.inited,t+h+this.id)?t+h:t;if(i.map._queue&&Object.hasOwn(i.map._queue,c)&&!i.data.inited[c+this.id])return Z(this,i.map._queue[c],(()=>this.update(void 0,void 0,!0)));!e.valid&&i.data.inited[t]&&(e.state="",r.dataview(e,void 0,!0)),this.parsed.view=e,this.parsed.dataset=t;const m=e.value()+c+i.settings.background_shapes+i.data.inited[this.options.background_shapes],u=e.selection.all,f=e.selection[i.settings.background_shapes&&this.options.background_shapes?"ids":"all"],b=p.border,g=X(this.color||e.y),_="all"===i.settings.summary_selection||"children"===i.settings.summary_selection?"subset_rank":"rank",y=this.time?v[this.time]:e.time_agg?Object.hasOwn(v,e.time_agg)?v[e.time_agg]:parseInt(e.time_agg):0;var n,l,d,o=0;if(i.settings.map_overlay&&Object.hasOwn(i.map[this.id].triggers,g)?te(this,i.map[this.id].triggers[g],i.data.meta.overall.value[e.parsed.time_agg]):(this.overlay_control.remove(),this.overlay.clearLayers()),i.data.inited[c+this.id]&&f&&e.valid){if(m!==this.vstate){for(n in this.map._zoomAnimated="none"!==i.settings.map_animations,this.reference_options)Object.hasOwn(this.reference_options,n)&&(this.options[n]=X(this.reference_options[n]),"zoomAnimation"===n&&(this.map._zoomAnimated=this.options[n]));for(n in this.displaying.clearLayers(),this.fresh_shapes=!0,this.vstate=!1,f)if(l=Object.hasOwn(u,n),Object.hasOwn(f,n)&&f[n].layer&&f[n].layer[this.id]){const e=f[n].layer[this.id].has_time?f[n].layer[this.id][h]:f[n].layer[this.id];e&&(l||this.options.background_shapes===i.data.entities[n].group)&&(o++,e.options.interactive=l,e.addTo(this.displaying),l||(e.bringToBack(),e.setStyle({fillOpacity:0,color:b,weight:.3})),this.vstate||(this.vstate=m))}this.overlay.bringToFront(),o&&this.map["fly"===i.settings.map_animations?"flyToBounds":"fitBounds"](this.displaying.getBounds())}if(this.parsed.palette=X(e.palette)||i.settings.palette,Object.hasOwn(a,this.parsed.palette)||(this.parsed.palette=p.palette),this.parsed.time=(y.parsed?y.value()-i.data.meta.times[t].range[0]:0)-i.data.variables[g].time_range[t][0],this.parsed.color=g,this.parsed.summary=!!Object.hasOwn(i.data.variables[g],this.view)&&i.data.variables[g][this.view].summaries[t],n=g+this.vstate+this.parsed.palette+this.parsed.time+i.settings.polygon_outline+i.settings.color_by_order+i.settings.color_scale_center,g&&n!==this.cstate)if(this.cstate=n,i.map[this.id]&&Object.hasOwn(i.data.variables[g],this.view)){const e=this.displaying._layers;for(d in o=this.parsed.summary.n[this.parsed.time]-1,e)Object.hasOwn(e,d)&&(n=e[d].entity.features.id,l=Object.hasOwn(u,n)&&Object.hasOwn(u[n][this.view][_],g)?O(u[n].get_value(g,this.parsed.time),this.parsed.palette,this.parsed.summary,this.parsed.time,u[n][this.view][_][g][this.parsed.time]-this.parsed.summary.missing[this.parsed.time],o):p.missing,t===e[d].entity.group&&e[d].setStyle({fillOpacity:.7,color:p.border,fillColor:l,weight:i.settings.polygon_outline}))}else Object.hasOwn(i.map,"_waiting")||(i.map._waiting={}),Object.hasOwn(i.map._waiting,t)||(i.map._waiting[t]=[]),-1===i.map._waiting[t].indexOf(this.id)&&i.map._waiting[t].push(this.id),-1===i.map._waiting[t].indexOf(this.view)&&i.map._waiting[t].push(this.view)}}}else this.tab&&!this.tab.classList.contains("show")||(this.queue=setTimeout((()=>this.update(void 0,void 0,!0)),50))}},info:{init:function(e){var a,n,r,l;function o(e,t){const a={parent:e,text:t,parsed:{},ref:!0,selection:!1,get:function(t,a){if(this.ref){if(t){if(Object.hasOwn(this.parsed,"features"))return t.features[this.parsed.features];if(Object.hasOwn(this.parsed,"data")){"value"===this.text?this.parsed.data=X(e.options.variable||a.color||a.y||v[e.view].y):Object.hasOwn(v,this.text)&&(this.parsed.data=X(this.text));const n=i.data.variable_info[this.parsed.data],r=i.data.format_value(t.get_value(this.parsed.data,this.parent.time),!n||!n.type||s.int_types.test(n.type));return"unknown"!==r&&Object.hasOwn(d,n.type)?d[n.type](r):r}}return Object.hasOwn(this.parsed,"data")?i.data.meta.times[this.parent.dataset].value[this.parent.time_agg]:Object.hasOwn(this.parsed,"variables")&&(this.value_source||Object.hasOwn(i.data.variable_info,this.parent.v))?i.data.variable_info[X(this.value_source||this.parent.v)][this.parsed.variables]:this.text}return this.text}};return"value"===t?a.parsed.data=e.options.variable:s.features.test(t)?a.parsed.features=t.replace(s.features,""):s.data.test(t)?a.parsed.data=t.replace(s.data,""):s.variables.test(t)?a.parsed.variables=t.replace(s.variables,""):a.ref=!1,a}if(e.view=e.options.dataview||p.dataview,e.depends={},e.has_default=e.options.default&&(e.options.default.title||e.options.default.body),N(e.view,e),e.options.floating&&(t.body.appendChild(e.e),e.e.classList.add("hidden"),t.addEventListener("mousemove",(function(t){if(e.showing){const i=h.content.getBoundingClientRect();e.e.style.top=(t.y>i.height/2?t.y-e.e.getBoundingClientRect().height-10:t.y+10)+"px",e.e.style.left=(t.x>i.width/2?t.x-e.e.getBoundingClientRect().width-10:t.x+10)+"px"}}))),e.show=function(e,t){this.update(e,t),this.showing=!0,this.options.floating&&this.e.classList.remove("hidden"),this.parts.title&&(this.selection?this.parts.title.base.classList.add("hidden"):this.parts.title.default.classList.add("hidden"),this.parts.title.temp.classList.remove("hidden")),this.parts.body&&(this.selection?this.parts.body.base.classList.add("hidden"):this.parts.body.default.classList.add("hidden"),this.parts.body.temp.classList.remove("hidden"))},e.revert=function(){this.showing=!1,this.options.floating?this.e.classList.add("hidden"):(this.parts.title&&(this.selection?this.parts.title.base.classList.remove("hidden"):this.has_default&&this.parts.title.default.classList.remove("hidden"),this.parts.title.temp.classList.add("hidden")),this.parts.body&&(this.selection?this.parts.body.base.classList.remove("hidden"):this.has_default&&this.parts.body.default.classList.remove("hidden"),this.parts.body.temp.classList.add("hidden")))},e.parts={},e.options.title&&(e.parts.title=o(e,e.options.title),Object.hasOwn(e.parts.title.parsed,"variables")&&s.measure_name.test(e.parts.title.parsed.variables)?(e.parts.title.base=t.createElement("button"),e.parts.title.base.type="button",e.parts.title.base.setAttribute("data-bs-toggle","modal"),e.parts.title.base.setAttribute("data-bs-target","#variable_info_display"),e.parts.title.base.addEventListener("click",M.bind(e))):e.parts.title.base=t.createElement("p"),e.parts.title.temp=t.createElement("p"),e.parts.title.default=t.createElement("p"),e.parts.title.temp.className=e.parts.title.base.className=e.parts.title.default.className="info-title hidden",e.has_default&&e.options.default.title&&(e.e.appendChild(e.parts.title.default),e.parts.title.default.innerText=e.options.default.title),e.parts.title.ref||(e.parts.title.base.innerText=e.parts.title.get()),e.e.appendChild(e.parts.title.base),e.e.appendChild(e.parts.title.temp),e.parts.title.base.classList.add("hidden"),e.parts.title.temp.classList.add("hidden")),e.options.body){for(e.parts.body={base:t.createElement("div"),temp:t.createElement("div"),default:t.createElement("div"),rows:[]},e.parts.body.temp.className=e.parts.body.base.className=e.parts.body.default.className="info-body hidden",e.has_default&&e.options.default.body&&(e.parts.body.default.innerText=e.options.default.body),n=e.options.body.length,a=0,r=0;a<n;a++)e.parts.body.rows[a]=l={name:o(e,e.options.body[a].name),value:o(e,e.options.body[a].value)},l.base=t.createElement("div"),e.parts.body.base.appendChild(l.base),l.temp=t.createElement("div"),e.parts.body.temp.appendChild(l.temp),l.temp.className=l.base.className="info-body-row-"+e.options.body[a].style,r+=24+("stack"===e.options.body[a].style?24:0),l.name&&(e.options.variable_info&&Object.hasOwn(l.name.parsed,"variables")&&s.measure_name.test(l.name.parsed.variables)?(l.base.appendChild(t.createElement("button")),l.base.lastElementChild.type="button",l.base.lastElementChild.setAttribute("data-bs-toggle","modal"),l.base.lastElementChild.setAttribute("data-bs-target","#variable_info_display"),l.base.lastElementChild.addEventListener("click",M.bind(e))):l.base.appendChild(t.createElement("div")),l.temp.appendChild(t.createElement("div")),l.temp.lastElementChild.className=l.base.lastElementChild.className="info-body-row-name",l.temp.lastElementChild.innerText=l.base.lastElementChild.innerText=l.name.get()),l.value&&(l.base.appendChild(t.createElement("div")),l.temp.appendChild(t.createElement("div")),l.temp.lastElementChild.className=l.base.lastElementChild.className="info-body-row-value"+("statement"===l.value.parsed.variables?" statement":""),l.value.ref||(l.temp.lastElementChild.innerText=l.base.lastElementChild.innerText=l.value.get()));e.e.style.minHeight=r+"px",e.e.appendChild(e.parts.body.base),e.e.appendChild(e.parts.body.default),e.e.appendChild(e.parts.body.temp)}e.update()},update:function(e,a,s){const n=i.dataviews[this.view||p.dataview];var r,l,d,o,h,c,m=v[n.time_agg];if(this.v=X(this.options.variable||a&&(a.color||a.y)||n.y),this.dataset=n.get.dataset(),!m||Object.hasOwn(i.data.meta.times,this.dataset)){if(this.time_agg=m?m.value()-i.data.meta.times[this.dataset].range[0]:0,this.time=this.v?this.time_agg-i.data.variables[this.v].time_range[this.dataset][0]:0,!this.processed&&(this.processed=!0,this.view?(T(this.view,{type:"update",id:this.id}),Object.hasOwn(v,n.y)&&T(n.y,{type:"update",id:this.id}),m&&T(n.time_agg,{type:"update",id:this.id})):this.view=p.dataview,this.parts.body))for(d=this.parts.body.rows.length;d--;)(r=this.parts.body.rows[d]).value.ref||Object.hasOwn(v,r.value.text)&&Object.hasOwn(r.name.parsed,"variables")&&(r.name.value_source=r.value.value_source=r.value.text,r.value.ref=!0,r.value.parsed.data="");if(e){if(this.parts.title&&(this.parts.title.temp.innerText=this.parts.title.get(e,a)),this.parts.body)for(d=this.parts.body.rows.length;d--;)(r=this.parts.body.rows[d]).name.ref&&(r.name.value_source&&(r.name.value_source=r.value.text),"object"!=typeof(l=r.name.get(e,a))&&(r.temp.firstElementChild.innerText=S(l,r.value.parsed.variables,this,e))),r.value.ref&&(r.value.value_source&&(r.value.value_source=r.value.text),"object"!=typeof(l=r.value.get(e,a))&&(r.temp.lastElementChild.innerText=S(l,r.value.parsed.variables,this,e)))}else if(!this.options.floating)if(clearTimeout(this.queue),s){if(n.ids&&(c=n.get.ids())&&"-1"!==c?(this.selection=!0,e=i.data.entities[c],this.parts.title&&(this.parts.title.value_source&&(r.title.value_source=r.value.text),this.parts.title.base.classList.remove("hidden"),this.parts.title.default.classList.add("hidden")),this.parts.body&&this.has_default&&this.parts.body.default.classList.add("hidden")):(this.selection=!1,this.parts.title&&(this.has_default?(this.parts.title.base.classList.add("hidden"),this.parts.title.default.classList.remove("hidden")):this.parts.title.base.classList.remove("hidden")),this.parts.body&&(this.parts.body.base.classList.add("hidden"),this.has_default&&this.parts.body.default.classList.remove("hidden"))),this.parts.title&&(this.parts.title.base.innerText=this.parts.title.get(e,a)),this.parts.body)for(this.options.subto||this.parts.body.base.classList.remove("hidden"),d=this.parts.body.rows.length;d--;)if(r=this.parts.body.rows[d],Object.hasOwn(r.value.parsed,"variables")&&!Object.hasOwn(this.depends,n.y)&&(this.depends[n.y]=!0,T(n.y,{type:"update",id:this.id})),r.name.ref&&(r.name.value_source&&(r.name.value_source=r.value.text),"object"!=typeof(l=r.name.get(e,a))&&(r.base.firstElementChild.innerText=l)),r.value.ref)if("object"==typeof(l=r.value.get(e,a))){if("sources"===r.value.parsed.variables)for(r.base.innerHTML="",r.base.appendChild(t.createElement("table")),r.base.lastElementChild.className="source-table",r.base.firstElementChild.appendChild(t.createElement("thead")),r.base.firstElementChild.firstElementChild.appendChild(t.createElement("tr")),r.base.firstElementChild.firstElementChild.firstElementChild.appendChild(t.createElement("th")),r.base.firstElementChild.firstElementChild.firstElementChild.appendChild(t.createElement("th")),r.base.firstElementChild.firstElementChild.firstElementChild.firstElementChild.innerText="Source",r.base.firstElementChild.firstElementChild.firstElementChild.lastElementChild.innerText="Accessed",r.base.firstElementChild.appendChild(t.createElement("tbody")),o=l.length,h=0;h<o;h++)r.base.firstElementChild.lastElementChild.appendChild(q(l[h]))}else r.base.lastElementChild.innerText=S(l,r.value.parsed.variables,this,e)}else this.tab&&!this.tab.classList.contains("show")||(this.queue=setTimeout((()=>this.update(void 0,void 0,!0)),50));this.revert()}}},datatable:{init:function(e){var a,n,r,d,o;e.e.appendChild(t.createElement("tHead")),e.e.appendChild(t.createElement("tBody")),e.click=e.e.getAttribute("click"),e.features=e.options.features,e.parsed={summary:{},order:[],time:0,color:"",dataset:v[e.view].get.dataset()},e.header=[],e.rows={},e.rowIds={},e.tab="tabpanel"===e.e.parentElement.getAttribute("role")?e.e.parentElement:void 0;const h=i.data.meta.times[e.parsed.dataset];if(e.tab&&t.getElementById(e.e.parentElement.getAttribute("aria-labelledby")).addEventListener("click",function(){e.e.parentElement.classList.contains("active")||(setTimeout(this.update,155),setTimeout(V,155))}.bind(e)),e.e.addEventListener("mouseover",l.datatable.mouseover.bind(e)),e.e.addEventListener("mouseout",l.datatable.mouseout.bind(e)),e.click&&(Object.hasOwn(v,e.click)&&(e.clickto=v[e.click]),e.e.addEventListener("click",l.datatable.click.bind(e))),e.show=function(e){if(e.features&&Object.hasOwn(this.rows,e.features.id)){const t=this.rows[e.features.id].node();t&&(t.style.backgroundColor=p.background_highlight,i.settings.table_autoscroll&&this.e.parentElement.scroll({top:t.getBoundingClientRect().y-this.e.getBoundingClientRect().y,behavior:i.settings.table_scroll_behavior||"smooth"}))}},e.revert=function(e){if(e.features&&Object.hasOwn(this.rows,e.features.id)){const t=this.rows[e.features.id].node();t&&(t.style.backgroundColor="inherit")}},e.options.variable_source=e.options.variables,e.options.variables?"string"==typeof e.options.variables&&(Object.hasOwn(v,e.options.variables)?(T(e.options.variables,{type:"update",id:e.id}),e.options.variables=X(e.options.variables),e.options.single_variable="string"==typeof e.options.variables):e.options.single_variable||(e.options.single_variable=[{name:e.options.single_variable}])):e.options.variables=Object.keys(i.data.variables),"string"!=typeof e.options.variables&&e.options.variables.length&&"string"===e.options.variables[0])for(r=e.options.variables.length;r--;)e.options.variables[r]={name:e.options.variables[r]};if(e.options.single_variable){for(a=(d=e.options.variables).name||d,e.header.push({title:"Name",data:"entity.features.name"}),h.is_single&&(e.variable_header=!0),n=(o=i.data.variables[a].time_range[e.parsed.dataset])[2];n--;)e.header[n+1]={title:e.variable_header?d.title||i.data.format_label(a):h.value[n+o[0]]+"",data:i.data.retrievers.vector,render:i.data.retrievers.row_time.bind({i:n,o:o[0],format_value:i.data.format_value.bind(i.data)})};e.options.order=[[e.header.length-1,"dsc"]]}else if(e.options.wide){if(e.features)for("string"==typeof e.features&&(e.features=[{name:e.features}]),n=e.features.length,r=0;r<n;r++)e.header.push({title:e.features[r].title||e.features[r].name,data:"entity.features."+e.features[r].name.replace(s.all_periods,"\\.")});for(r=e.options.variables.length;r--;)"string"==typeof e.options.variables[r]&&(e.options.variables[r]={name:e.options.variables[r]}),(d=e.options.variables[r]).source||(d.source=Object.hasOwn(i.data.variables,d.name)?"data":"features"),e.header.push("features"===d.source?{title:d.title||i.data.format_label(d.name),data:"entity.features."+d.name.toLowerCase().replace(s.all_periods,"\\.")}:{title:d.title||i.data.format_label(d.name),render:function(e,t,a){if("data"===this.c.source){if(Object.hasOwn(i.data.variables,this.c.name)){const e=a.time-i.data.variables[this.c.name].time_range[this.o.parsed.dataset][0];return e<0?NaN:a.entity.get_value(this.c.name,e)}return NaN}return Object.hasOwn(a.entity,this.c.source)&&Object.hasOwn(a.entity[this.c.source],this.c.name)?a.entity[this.c.source][this.c.name]:NaN}.bind({o:e,c:d})})}else{if(e.filters=e.options.filters,e.current_filter={},h.is_single||e.header.push({title:"Year",data:"entity.time.value",render:function(e,t,a){const s=a.time+a.offset;return e&&s>=0&&s<e.length?"number"==typeof e[s]?i.data.format_value(e[s],!0):e[s]:NaN}}),e.features)for("string"==typeof e.features&&(e.features=[{name:e.features}]),r=e.features.length;r--;)e.header.splice(0,0,{title:e.features[r].title||e.features[r].name,data:"entity.features."+e.features[r].name.replace(s.all_periods,"\\.")});e.header.push({title:"Variable",data:function(e){return Object.hasOwn(e.entity.variables,e.variable)?e.entity.variables[e.variable].meta.short_name:e.variable}}),e.header.push({title:"Value",data:i.data.retrievers.vector,render:function(e,t,a){return e?"number"==typeof e[a.time]?i.data.format_value(e[a.time],a.int):e[a.time]:""}})}e.view?(g[e.view].push({type:"update",id:e.id}),g[e.view+"_filter"].push({type:"update",id:e.id})):e.view=p.dataview,pe.bind(e)()},update:function(e){if(clearTimeout(this.queue),e){if(this.table){var t=this.options.variable_source&&X(this.options.variable_source).replace(s.all_periods,"\\.");const p=v[this.view],m=p.get.dataset(),u=m+p.value()+p.get.time_filters()+i.settings.digits+t;if(!i.data.inited[m])return;if(u!==this.state){if(this.rows={},this.rowIds={},this.table.clear(),p.selection){this.state=u;var a,n,r,l,d,o=!0,h=!0,c=""+this.parsed.dataset+p.get.ids()+p.get.features()+i.settings.digits;for(a in this.reference_options)Object.hasOwn(this.reference_options,a)&&(this.options[a]=X(this.reference_options[a]));if(this.options.single_variable){const e=X(p.time_agg);if(this.parsed.dataset=m,this.parsed.color=t,this.parsed.time_range=i.data.variables[t].time_range[m],this.parsed.time=("number"==typeof e?e-i.data.meta.times[m].range[0]:0)-this.parsed.time_range[0],this.parsed.summary=!!Object.hasOwn(i.data.variables[t],this.view)&&i.data.variables[t][this.view].summaries[m],this.parsed.order=!!Object.hasOwn(i.data.variables[t],this.view)&&i.data.variables[t][this.view].order[m][this.parsed.time],this.header.length<2||m!==this.header[1].dataset||t!==this.header[1].variable){if(this.table.destroy(),$(this.e).empty(),this.header=[{title:"Name",data:"entity.features.name"}],-1!==this.parsed.time_range[0])for(l=this.parsed.time_range[2];l--;)this.header[l+1]={dataset:m,variable:t,title:this.variable_header?this.options.variables.title||i.data.format_label(a):i.data.meta.times[m].value[l+this.parsed.time_range[0]]+"",data:i.data.retrievers.vector,render:i.data.retrievers.row_time.bind({i:l,o:this.parsed.time_range[0],format_value:i.data.format_value.bind(i.data)})};else this.state="";this.options.order[0][0]=this.header.length-1,this.options.columns=this.header,this.table=$(this.e).DataTable(this.options)}for(l=this.header.length,r=1;r<l;r++)this.table.column(r).visible(p.times[r-1+this.parsed.time_range[0]],!1),p.times[r-1+this.parsed.time_range[0]]&&(o=!1);o&&(this.state="")}if(this.options.wide){for(a in p.selection.all)if(Object.hasOwn(p.selection.all,a))if(t)Object.hasOwn(p.selection.all[a][this.view].summary,t)&&(this.rows[a]=this.table.row.add({dataset:m,variable:t,offset:this.parsed.time_range[0],entity:p.selection.all[a],int:s.int_types.test(i.data.variable_info[t].type)}),this.rowIds[this.rows[a].selector.rows]=a);else for(r=i.data.meta.times[m].n;r--;)this.rows[a]=this.table.row.add({time:r,entity:p.selection.all[a]}),this.rowIds[this.rows[a].selector.rows]=a}else{for(n in this.filters)Object.hasOwn(this.filters,n)&&(this.current_filter[n]=X(this.filters[n]));for(d=[],r=this.options.variables.length;r--;){if(t=this.options.variables[r].name||this.options.variables[r],e=!1,Object.hasOwn(i.data.variables,t)&&Object.hasOwn(i.data.variables[t],"meta"))if(this.options.filters){for(n in this.current_filter)if(Object.hasOwn(i.data.variables[t].meta,n)&&!(e=i.data.variables[t].meta[n]===this.current_filter[n]))break}else e=!0;e&&(c+=t,d.push({variable:t,int:s.int_types.test(i.data.variable_info[t].type),time_range:i.data.variables[t].time_range[m],renderer:function(e,t){for(var i=this.time_range,s=i[1],n=i[0];n<=s;n++)e.rows[t.features.id]=e.table.row.add({offset:this.time_range[0],time:n-this.time_range[0],dataset:m,variable:this.variable,entity:t,int:this.int}),e.rowIds[e.rows[a].selector.rows]=t.features.id}}))}if(c===this.varstate)return;for(a in this.varstate=c,p.selection.all)if(Object.hasOwn(p.selection.all,a))if(this.options.single_variable)Object.hasOwn(p.selection.all[a][p].summary,t)&&Object.hasOwn(p.selection.all[a].data,i.data.variables[t].code)&&(this.rows[a]=this.table.row.add({offset:this.parsed.time_range[0],dataset:m,variable:t,entity:p.selection.all[a],int:s.int_types.test(i.data.variable_info[t].type)}),this.rowIds[this.rows[a].selector.rows]=a);else for(r=d.length;r--;)Object.hasOwn(p.selection.all[a].data,i.data.variables[d[r].variable].code)&&d[r].renderer(this,p.selection.all[a])}}h?this.table.draw():this.table.columns.adjust().draw(!1)}}}else this.tab&&!this.tab.classList.contains("show")||(this.queue=setTimeout((()=>this.update(!0)),50))},mouseover:function(e){if(e.target._DT_CellIndex&&Object.hasOwn(this.rowIds,e.target._DT_CellIndex.row)){const t=this.rowIds[e.target._DT_CellIndex.row],a=this.rows[t].node();a&&(a.style.backgroundColor=p.background_highlight),Object.hasOwn(i.data.entities,t)&&A(this.id,"show",i.data.entities[t])}},mouseout:function(e){if(e.target._DT_CellIndex&&Object.hasOwn(this.rowIds,e.target._DT_CellIndex.row)){const t=this.rowIds[e.target._DT_CellIndex.row],a=this.rows[t].node();a&&(a.style.backgroundColor="inherit"),Object.hasOwn(i.data.entities,t)&&A(this.id,"revert",i.data.entities[t])}},click:function(e){if(this.clickto&&e.target._DT_CellIndex&&Object.hasOwn(this.rowIds,e.target._DT_CellIndex.row)){const t=this.rowIds[e.target._DT_CellIndex.row];Object.hasOwn(i.data.entities,t)&&this.clickto.set(t)}}},legend:{init:function(e){var a,s;for(a in T(e.view,{type:"update",id:e.id}),v[e.view].y&&T(v[e.view].y,{type:"update",id:e.id}),Object.hasOwn(v,v[e.view].time_agg)&&T(v[e.view].time_agg,{type:"update",id:e.id}),e.palette||(v[e.view].palette?(e.palette=v[e.view].palette,Object.hasOwn(v,v[e.view].palette)&&T(v[e.view].palette,{type:"update",id:e.id})):e.palette=Object.hasOwn(v,"settings.palette")?"settings.palette":i.settings.palette),e.parsed={summary:{},order:[],selection:{},selected_summary:{},time:0,color:""},e.parts={ticks:e.e.getElementsByClassName("legend-ticks")[0],scale:e.e.getElementsByClassName("legend-scale")[0],summary:e.e.getElementsByClassName("legend-summary")[0]},e.parts.ticks.setAttribute("of",e.id),e.parts.scale.setAttribute("of",e.id),e.parts.summary.setAttribute("of",e.id),e.e.addEventListener("mousemove",l.legend.mouseover.bind(e)),e.e.addEventListener("mouseout",l.legend.mouseout.bind(e)),e.e.addEventListener("click",l.legend.click.bind(e)),e.click=e.e.getAttribute("click"),Object.hasOwn(v,e.click)&&(e.clickto=v[e.click]),e.ticks={center:e.parts.summary.appendChild(t.createElement("div")),min:e.parts.summary.appendChild(t.createElement("div")),max:e.parts.summary.appendChild(t.createElement("div")),entity:e.parts.ticks.appendChild(t.createElement("div"))},e.ticks)Object.hasOwn(e.ticks,a)&&(e.ticks[a].setAttribute("of",e.id),e.ticks[a].className="legend-tick",e.ticks[a].appendChild(s=t.createElement("div")),s.setAttribute("of",e.id),s.appendChild(t.createElement("p")),s.lastElementChild.setAttribute("of",e.id),"m"!==a.substring(0,1)&&(s.appendChild(t.createElement("p")),s.lastElementChild.setAttribute("of",e.id),s.appendChild(t.createElement("p")),s.lastElementChild.setAttribute("of",e.id),"entity"===a?e.ticks[a].firstElementChild.lastElementChild.classList.add("entity"):e.ticks[a].firstElementChild.firstElementChild.classList.add("summary")));e.ticks.entity.firstElementChild.classList.add("hidden"),e.ticks.max.className="legend-tick-end max",e.ticks.min.className="legend-tick-end min",e.ticks.center.style.left="50%",e.show=function(e,t){if(e&&Object.hasOwn(t,"parsed")){const n=t.parsed.summary,r=n&&Object.hasOwn(n,"levels"),l=n&&!r?n.min[t.parsed.time]:0,d=n?r?n.levels.length-l:n.range[t.parsed.time]:1,o="all"===i.settings.summary_selection||"children"===i.settings.summary_selection?"subset_rank":"rank",h=e.get_value(t.parsed.color,t.parsed.time),c=n.n[t.parsed.time],p=100*((r?Object.hasOwn(n.level_ids,h):"number"==typeof h)?i.settings.color_by_order?NaN:Math.max(0,Math.min(1,d?((r?n.level_ids[h]:h)-l)/d:0)):NaN),m=this.ticks.entity.firstElementChild.children[1];if(isFinite(p))m.parentElement.classList.remove("hidden"),m.innerText=i.data.format_value(h,this.integer),this.ticks.entity.style.left=p+"%",this.ticks.entity.firstElementChild.firstElementChild.innerText=(p>96||p<4)&&e.features.name.length>13?e.features.name.substring(0,12)+"…":e.features.name;else if(i.settings.color_by_order&&Object.hasOwn(i.data.entities[e.features.id][this.view][o],t.parsed.color)){var a=i.data.entities[e.features.id][this.view][o][t.parsed.color][t.parsed.time]-n.missing[t.parsed.time],s=a/(c-1)*100;this.ticks.entity.firstElementChild.firstElementChild.innerText=a>-1&&(s>96||s<4)&&e.features.name.length>13?e.features.name.substring(0,12)+"…":e.features.name,a>-1&&(m.parentElement.classList.remove("hidden"),m.innerText="# "+(c-a),this.ticks.entity.style.left=s+"%")}this.ticks.entity.style.marginLeft=-this.ticks.entity.getBoundingClientRect().width/2+"px"}},e.revert=function(){this.ticks.entity.firstElementChild.classList.add("hidden")},T(e.view,{type:"update",id:e.id}),v[e.palette]&&v[e.palette].e&&v[e.palette].e.addEventListener("change",e.update),e.update()},update:function(){const e=v[this.view],n=X(e.y),r=X(e.time_agg),l=e.get.dataset(),d=("number"==typeof r?r-i.data.meta.times[l].range[0]:0)-i.data.variables[n].time_range[l][0],o=!!Object.hasOwn(i.data.variables[n],this.view)&&i.data.variables[n][this.view].summaries[l],h=X(this.palette).toLowerCase(),c=Object.hasOwn(a,h)?h:Object.hasOwn(a,i.settings.palette)?i.settings.palette:p.palette,u=a[c].colors;if(this.parsed.summary=o,this.parsed.selected_summary=!!Object.hasOwn(i.data.variables[n],this.view)&&i.data.variables[n][this.view].selected_summaries[l],this.parsed.order=!!Object.hasOwn(i.data.variables[n],this.view)&&i.data.variables[n][this.view].selected_order[l][d],this.parsed.time=d,this.parsed.color=n,e.valid&&o&&d<o.n.length){if(this.integer=!i.data.variable_info[n]||!i.data.variable_info[n].type||s.int_types.test(i.data.variable_info[n].type),c!==this.current_palette+i.settings.color_scale_center)if(this.current_palette=c+i.settings.color_scale_center,this.parts.scale.innerHTML="","discrete"===a[c].type)if(i.settings.color_by_order||"none"===i.settings.color_scale_center)for(var f=0,b=u.length;f<b;f++)this.parts.scale.appendChild(t.createElement("span")),this.parts.scale.lastElementChild.setAttribute("of",this.id),this.parts.scale.lastElementChild.style.backgroundColor=u[f];else{var g;f=0,b=Math.ceil(u.length/2);for(this.parts.scale.appendChild(g=t.createElement("div")),g.setAttribute("of",this.id),g.style.left=0;f<b;f++)g.appendChild(t.createElement("span")),g.lastElementChild.setAttribute("of",this.id),g.lastElementChild.style.backgroundColor=u[f];for(this.parts.scale.appendChild(g=t.createElement("div")),g.setAttribute("of",this.id),g.style.right=0,f=Math.floor(u.length/2),b=u.length;f<b;f++)g.appendChild(t.createElement("span")),g.lastElementChild.setAttribute("of",this.id),g.lastElementChild.style.backgroundColor=u[f]}else this.parts.scale.appendChild(t.createElement("span")),this.parts.scale.appendChild(t.createElement("span")),this.parts.scale.firstElementChild.style.background="linear-gradient(0.25turn, rgb("+u[2][0][0]+", "+u[2][0][1]+", "+u[2][0][2]+"), rgb("+u[1][0]+", "+u[1][1]+", "+u[1][2]+"))",this.parts.scale.lastElementChild.style.background="linear-gradient(0.25turn, rgb("+u[1][0]+", "+u[1][1]+", "+u[1][2]+"), rgb("+u[0][0][0]+", "+u[0][0][1]+", "+u[0][0][2]+"))";i.settings.color_by_order?(this.ticks.center.classList.add("hidden"),this.ticks.min.firstElementChild.firstElementChild.innerText="# "+(o.n[d]?o.n[d]:0),this.ticks.max.firstElementChild.firstElementChild.innerText="# "+(o.n[d]?1:0)):(this.ticks.center.classList.remove("hidden"),this.ticks.min.firstElementChild.firstElementChild.innerText=o.n[d]&&isFinite(o.min[d])?i.data.format_value(o.min[d],this.integer):"unknown",this.ticks.max.firstElementChild.firstElementChild.innerText=o.n[d]&&isFinite(o.max[d])?i.data.format_value(o.max[d],this.integer):"unknown","none"!==i.settings.color_scale_center?(this.ticks.center.firstElementChild.lastElementChild.innerText=m[i.settings.summary_selection]+" "+i.settings.color_scale_center,this.ticks.center.firstElementChild.children[1].innerText=i.data.format_value(o[i.settings.color_scale_center][d]),this.ticks.center.style.left=100*o["norm_"+i.settings.color_scale_center][d]+"%"):(this.ticks.center.firstElementChild.lastElementChild.innerText=m[i.settings.summary_selection]+" median",this.ticks.center.firstElementChild.children[1].innerText=i.data.format_value(o.median[d]),this.ticks.center.style.left=100*o.norm_median[d]+"%"),2===this.parts.scale.childElementCount&&("none"===i.settings.color_scale_center?(this.parts.scale.firstElementChild.style.width="50%",this.parts.scale.lastElementChild.style.width="50%"):(this.parts.scale.firstElementChild.style.width=100*o["norm_"+i.settings.color_scale_center][d]+"%",this.parts.scale.lastElementChild.style.width=100-100*o["norm_"+i.settings.color_scale_center][d]+"%")),this.ticks.center.style.marginLeft=-this.ticks.center.getBoundingClientRect().width/2+"px")}},mouseover:function(e){const t=this.parts.scale.getBoundingClientRect(),a=(Math.max(t.x,Math.min(t.x+t.width,e.clientX))-t.x)/t.width;var s=!1;if(i.settings.color_by_order)s=i.data.entities[this.parsed.order[Math.max(this.parsed.selected_summary.missing[this.parsed.time],Math.min(this.parsed.order.length-1,Math.floor((this.parsed.order.length-1)*a)))][0]];else{const e=this.parsed.summary.min[this.parsed.time],t=e+a*(this.parsed.summary.max[this.parsed.time]-e);var n,r;if(this.parsed.order&&this.parsed.order.length&&(r=this.parsed.selected_summary.missing[this.parsed.time])<this.parsed.order.length)if(1!==this.parsed.order.length&&a){for(n=this.parsed.order.length-2;n>=r&&!((this.parsed.order[n][1]+this.parsed.order[n+1][1])/2<=t);--n);n++,s=i.data.entities[this.parsed.order[n][0]]}else s=i.data.entities[this.parsed.order[r][0]]}s&&(this.show(s,this),this.entity&&s.features.id===this.entity.features.id||(this.entity?A(this.id,"revert",this.entity):this.entity=s,A(this.id,"show",s),this.entity=s))},mouseout:function(e){e.relatedTarget&&this.id!==e.relatedTarget.getAttribute("of")&&(this.revert(),this.entity&&(A(this.id,"revert",this.entity),this.entity=!1))},click:function(){this.clickto&&this.entity&&(this.revert(),this.clickto.set(this.entity.features.id))}},credits:{init:function(e){var a,s,n=i.credit_output&&i.credit_output[e.id];for(a in e.exclude=[],e.add={},e.exclude=n&&n.exclude||[],e.add=n&&n.add||{},e.e.appendChild(t.createElement("ul")),i.credits)Object.hasOwn(i.credits,a)&&-1===e.exclude.indexOf(a)&&(e.e.lastElementChild.appendChild(s=t.createElement("li")),Object.hasOwn(i.credits[a],"url")&&(s.appendChild(s=t.createElement("a")),s.href=i.credits[a].url,s.target="_blank",s.rel="noreferrer"),s.innerText=i.credits[a].name,Object.hasOwn(i.credits[a],"version")&&(s.appendChild(t.createElement("span")),s.lastElementChild.className="version-tag",s.lastElementChild.innerText=i.credits[a].version),Object.hasOwn(i.credits[a],"description")&&(s.parentElement.appendChild(t.createElement("p")),s.parentElement.lastElementChild.innerText=i.credits[a].description))}}},d={percent:function(e){return e+"%"},"drive time":function(e){return e+" minutes"},minutes:function(e){return e+" minutes"},dollar:function(e){return"$"+e},"internet speed":function(e){return e+" MB/s"}},o=e.localStorage||{setItem:function(){},getItem:function(){},removeItem:function(){}},h={load_screen:t.getElementById("load_screen"),wrap:t.getElementById("site_wrap"),navbar:t.getElementsByClassName("navbar")[0],content:t.getElementsByClassName("content")[0],menus:t.getElementsByClassName("menu-wrapper"),panels:t.getElementsByClassName("panel")},c={_timeout:0},p={time:"time",dataview:"default_view",palette:"vik",background_highlight:"#adadad",border:"#7e7e7e",border_highlight_true:"#ffffff",border_highlight_false:"#000000",missing:"#00000000",polygon_outline:1.5,circle_radius:20},m={dataset:"Overall",filtered:"Filtered",all:"Selection"},u={retain_state:!0},f={},b={},v={},g={},_={};if(t.body.className=e.localStorage&&"true"===e.localStorage.getItem("theme_dark")||i.settings.theme_dark?"dark-theme":"light-theme",h.content){for(var y=h.menus.length,w=h.navbar?h.navbar.getBoundingClientRect().height:0;y--;)if(h.menus[y].classList.contains("menu-top")){w=h.menus[y].getBoundingClientRect().height;break}h.content.style.top=w+"px"}function O(e,t,n,r,l,d){if(isNaN(e))return p.missing;const o="none"!==i.settings.color_scale_center&&!i.settings.color_by_order,h="discrete"===a[t].type,c=a[t].colors,m=Object.hasOwn(n,"levels"),u=m?0:n.min[r],f=m?n.levels.length-u:n.range[r],b="none"===i.settings.color_scale_center||s.median.test(i.settings.color_scale_center)?"median":"mean",v=i.settings.color_by_order?o?n["break_"+b][r]/d:.5:isNaN(n["norm_"+b][r])?0:n["norm_"+b][r],g=h?o&&!i.settings.color_by_order?Math.ceil(c.length/2):c.length:1,_=i.settings.color_by_order?l/d:f?((m?n.level_ids[e]:e)-u)/f:0,y=_>(o?v:.5);var w=o?f?y?(_-v-n["upper_"+b+"_min"][r])/n["upper_"+b+"_range"][r]:(_+v-n["lower_"+b+"_min"][r])/n["lower_"+b+"_range"][r]:0:_;return h||(w=Math.max(0,Math.min(1,w)),y&&(w=1-w),o||(w*=2)),(m?Object.hasOwn(n.level_ids,e):"number"==typeof e)?h?c[Math.max(0,Math.min(c.length-1,Math.floor(o&&y?g-c.length%2+g*w:g*w)))]:"rgb("+(y?c[0][0][0]+w*c[0][1][0]+", "+(c[0][0][1]+w*c[0][1][1])+", "+(c[0][0][2]+w*c[0][1][2]):c[2][0][0]+w*c[2][1][0]+", "+(c[2][0][1]+w*c[2][1][1])+", "+(c[2][0][2]+w*c[2][1][2]))+")":p.missing}function E(e,i){Object.hasOwn(i,"button")||(i.button={}),"string"==typeof i.text&&(i.text=[i.text]),i.parts=t.createElement("span");for(var a,s=i.text.length,n=0;n<s;n++)Object.hasOwn(i.button,i.text[n])?(a=i.button[i.text[n]],i.parts.appendChild(t.createElement("button")),i.parts.lastElementChild.type="button",a.trigger=Y.bind({id:e.id+a.text,note:a.target,wrapper:i.parts.lastElementChild}),"note"===a.type?(i.parts.lastElementChild.setAttribute("aria-description",a.target),i.parts.lastElementChild.setAttribute("of",e.id+a.text),i.parts.lastElementChild.className="has-note",i.parts.lastElementChild.addEventListener("mouseover",a.trigger),i.parts.lastElementChild.addEventListener("focus",a.trigger),i.parts.lastElementChild.addEventListener("blur",Q)):(i.parts.lastElementChild.className="btn btn-link",v[a.target]&&"function"==typeof v[a.target][a.type]&&(i.parts.lastElementChild.setAttribute("aria-label",a.text.join("")),i.parts.lastElementChild.addEventListener("click",v[a.target][a.type])))):i.parts.appendChild(t.createElement("span"));if(Object.hasOwn(i,"condition"))for(n=i.condition.length;n--;)i.condition[n].id&&("default"===i.condition[n].id?i.condition[n].check=function(){return!0}:(e.depends[i.condition[n].id]="",i.condition[n].check=function(){return"default"===this.id||DataHandler.prototype.checks[this.type](X(this.id),X(this.value))}.bind(i.condition[n])))}function C(e,t,a){if(!Object.hasOwn(i.data.data_maps,t))return i.data.data_queue[t][e.id]=function(){return C(e,t,a)},void(i.data.loaded[t]&&i.data.load_id_maps());var s,n;for(n in a[t]={options:[],values:[],display:[]},s=a[t].options,e.values=a[t].values,e.display=a[t].display,i.data.entities)i.data.entities[n]&&t===i.data.entities[n].group&&(s.push(e.add(n,i.data.entities[n].features.name)),e.values.push(n),e.display.push(i.data.entities[n].features.name));Object.hasOwn(i.url_options,e.id)?e.set(i.url_options[e.id]):e.reset()}function x(e,t,a){var s,n,r,l,d;for(a[t]={options:[],values:[],display:[]},s=a[t].options,e.values=a[t].values,e.display=a[t].display,l=(r=i.metadata.info[t].schema.fields).length,n=0;n<l;n++)d=i.data.format_label(r[n].name),s[n]=e.add(n,d,r[n]),e.values.push(r[n].name),e.display.push(d);Object.hasOwn(i.url_options,e.id)?e.set(i.url_options[e.id]):e.reset()}function j(e,t,a,s){const n=i.data.variables[a].info[t],r="string"===n.type?"levels":"ids";var l,d,o,h,c=n[r];if(c)if(l=t+a,Object.hasOwn(s,l))for(e.values=s[l].values,e.display=s[l].display,o=(h=s[l].options).length,d=0;d<o;d++)h[d].length?(e.e.appendChild(h[d][0]),e.e.appendChild(h[d][1])):e.e.appendChild(h[d]);else for(l in s[l]={options:[],values:[],display:[]},h=s[l].options,e.values=s[l].values,e.display=s[l].display,d=0,c)Object.hasOwn(c,l)&&(h[d++]=e.add(c[l].id,c[l].name),e.values.push(c[l].id),e.display.push(c[l].name));else"ids"===r&&(i.data.data_queue[t][e.id]=function(){return j(e,t,a,s)},i.data.loaded[t]&&i.data.load_id_maps());Object.hasOwn(i.url_options,e.id)?e.set(i.url_options[e.id]):e.reset()}function k(e,t){return Object.hasOwn(_,e.id)&&Object.hasOwn(_,t.id)?_[e.id]._n.children-_[t.id]._n.children:-1/0}function T(e,t){Object.hasOwn(g,e)||(g[e]=[]),g[e].push(t),Object.hasOwn(_,e)||(_[e]={_n:{children:0,parents:0},children:{},parents:{}}),Object.hasOwn(_,t.id)||(_[t.id]={_n:{children:0,parents:0},children:{},parents:{}}),_[e].children[t.id]=_[t.id],_[e]._n.children++,_[t.id].parents[e]=_[e],_[t.id]._n.parents++,g[e].sort(k),le(e)}function N(e,t){Object.hasOwn(f,e)||(f[e]=[]),f[e].push(t)}function A(e,t,i){if(Object.hasOwn(f,e))for(var a=f[e].length;a--;)Object.hasOwn(f[e][a],t)&&f[e][a][t](i,v[e])}function B(e){if(e.dark_theme!==i.settings.theme_dark){e.dark_theme=i.settings.theme_dark;const a=getComputedStyle(t.body);Object.hasOwn(e,"style")||(e.style=e.options.layout,Object.hasOwn(e.style,"font")||(e.style.font={}),Object.hasOwn(e.style,"modebar")||(e.style.modebar={}),Object.hasOwn(e.style.xaxis,"font")||(e.style.xaxis.font={}),Object.hasOwn(e.style.yaxis,"font")||(e.style.yaxis.font={})),e.style.paper_bgcolor=a.backgroundColor,e.style.plot_bgcolor=a.backgroundColor,e.style.font.color=a.color,e.style.modebar.bgcolor=a.backgroundColor,e.style.modebar.color=a.color,e.e._fullLayout.xaxis.showgrid&&(e.style.xaxis.gridcolor=a.borderColor),e.e._fullLayout.yaxis.showgrid&&(e.style.yaxis.gridcolor=a.borderColor),e.style.xaxis.font.color=a.color,e.style.yaxis.font.color=a.color,Plotly.relayout(e.e,e.options.layout)}}function I(e,t,a,s,n,r){if(t.data&&Object.hasOwn(i.data.variables,e.parsed.x)){const o=i.data.retrievers.vector({variable:e.parsed.x,entity:t}),h=i.data.retrievers.vector({variable:e.parsed.y,entity:t});for(var l=i.data.variables[e.parsed.x].time_range[e.parsed.dataset][2],d=JSON.parse(e.traces[e.base_trace]);l--;)d.text[l]=t.features.name,d.x[l]=e.parsed.x_range[0]<=l&&l<=e.parsed.x_range[1]?o[l-e.parsed.x_range[0]]:NaN,d.y[l]=e.parsed.y_range[0]<=l&&l<=e.parsed.y_range[1]?h[l-e.parsed.y_range[0]]:NaN;return d.type=e.parsed.base_trace,d.color=d.line.color=d.marker.color=d.textfont.color=r||O(t.get_value(e.parsed.color,e.parsed.time),e.parsed.palette,e.parsed.summary,e.parsed.time,a,s)||p.border,"bar"===d.type&&(d.marker.line.width=0),d.name=n||t.features.name,d.id=t.features.id,d}}function q(e){var i=t.createElement("tr");return e.name&&(i.appendChild(t.createElement("td")),e.url?(i.firstElementChild.appendChild(t.createElement("a")),i.firstElementChild.firstElementChild.target="_blank",i.firstElementChild.firstElementChild.rel="noreferrer",i.firstElementChild.firstElementChild.href=e.url):i.firstElementChild.appendChild(t.createElement("span")),i.firstElementChild.firstElementChild.innerText=e.name),e.date_accessed&&(i.appendChild(t.createElement("td")),i.lastElementChild.appendChild(t.createElement("span")),i.lastElementChild.firstElementChild.innerText=e.date_accessed),i}function M(){const e=v[this.view],t=i.data.variable_info[X(this.v||e.y)];var a,s;if(h.modal.info.header.firstElementChild.innerText=t.short_name,h.modal.info.title.innerText=t.long_name,h.modal.info.description.innerText=t.long_description||t.description||t.short_description||"",h.modal.info.name.lastElementChild.innerText=t.measure||"",h.modal.info.type.lastElementChild.innerText=t.type||"",t.sources&&t.sources.length)for(h.modal.info.sources.lastElementChild.lastElementChild.innerHTML="",h.modal.info.sources.classList.remove("hidden"),a=t.sources.length,s=0;s<a;s++)h.modal.info.sources.lastElementChild.lastElementChild.appendChild(q(t.sources[s]));else h.modal.info.sources.classList.add("hidden");if(t.citations&&t.citations.length)for(h.modal.info.references.lastElementChild.innerHTML="",h.modal.info.references.classList.remove("hidden"),"string"==typeof t.citations&&(t.citations=[t.citations]),a=t.citations.length,s=0;s<a;s++)i.data.variable_info._references&&Object.hasOwn(i.data.variable_info._references,t.citations[s])&&h.modal.info.references.lastElementChild.appendChild(i.data.variable_info._references[t.citations[s]].element);else h.modal.info.references.classList.add("hidden")}function S(e,t,a,n){if("statement"===t)for(var r,l;r=s.mustache.exec(e);)"value"===r[1]?(l=n?i.data.format_value(n.get_value(a.v,a.time),s.int_types.test(i.data.variable_info[a.v].type)):"unknown",e=e.replace(r[0],"unknown"!==l&&Object.hasOwn(d,i.data.variable_info[a.v].type)?d[i.data.variable_info[a.v].type](l):l),s.mustache.lastIndex=0):n&&(s.features.test(r[1])?(e=e.replace(r[0],n.features[r[1].replace(s.features,"")]),s.mustache.lastIndex=0):s.variables.test(r[1])?(e=e.replace(r[0],n.variables[a.v][r[1].replace(s.variables,"")]),s.mustache.lastIndex=0):s.data.test(r[1])&&(e=e.replace(r[0],n.get_value(r[1].replace(s.data,""),a.time)),s.mustache.lastIndex=0));return e}var F,R,D,H;if(i.query=F=e.location.search.replace("?",""),i.url_options={},F)for(y=(R=F.split("&")).length;y--;)(H=R[y].split("=")).length<2&&H.push("true"),H[1]=s.bool.test(H[1])?"true"===H[1]:H[1].replace(s.url_spaces," "),i.url_options[H[0]]=H[1],s.settings.test(H[0])&&o.setItem(H[0].replace(s.settings,""),H[1]);if((Object.hasOwn(i.url_options,"embedded")||Object.hasOwn(i.url_options,"hide_navbar"))&&(Object.hasOwn(i.url_options,"hide_logo")||(i.url_options.hide_logo=!0),Object.hasOwn(i.url_options,"hide_title")||(i.url_options.hide_title=!0),Object.hasOwn(i.url_options,"hide_navcontent")||(i.url_options.hide_navcontent=!0),Object.hasOwn(i.url_options,"hide_panels")||(i.url_options.hide_panels=!0),Object.hasOwn(i.url_options,"embedded")&&!Object.hasOwn(i.url_options,"close_menus")&&(i.url_options.close_menus=!0)),(R=t.getElementsByClassName("navbar")[0])&&(Object.hasOwn(i.url_options,"navcolor")&&(""===i.url_options.navcolor&&(i.url_options.navcolor=e.location.hash),R.style.backgroundColor=i.url_options.navcolor.replace("%23","#")),i.url_options.hide_logo&&i.url_options.hide_title&&i.url_options.hide_navcontent?R.classList.add("hidden"):((R=t.getElementsByClassName("navbar-brand")[0])&&(i.url_options.hide_logo&&"IMG"===R.firstElementChild.tagName&&R.firstElementChild.classList.add("hidden"),i.url_options.hide_title&&"IMG"!==R.lastElementChild.tagName&&R.lastElementChild.classList.add("hidden")),i.url_options.hide_navcontent&&(t.getElementsByClassName("navbar-toggler")[0].classList.add("hidden"),(R=t.getElementsByClassName("navbar-nav")[0])&&R.classList.add("hidden"))),i.url_options.hide_panels&&h.panels.length))for(y=h.panels.length;y--;)h.panels[y].classList.add("hidden");for(F in i.settings)Object.hasOwn(o,F)&&(H=o.getItem(F),s.bool.test(H)?H="true"===H:s.number.test(H)&&(H=parseFloat(H)),i.settings[F]=H);function P(e,t,i){for(var a=i[0][e]+t*i[1][e],s=2,n=i.length;s<n;s++)a+=Math.pow(t,s)*i[s][e];return Math.max(0,Math.min(255,a))}for(F in a)if(a[F]&&"continuous-polynomial"===a[F].type){H=a[F].colors,a[F].type="discrete",a[F].colors=[],y=0;for(var z;y<255;y++)z=y/255,a[F].colors.push("rgb("+P(0,z,H)+", "+P(1,z,H)+", "+P(2,z,H)+")")}function G(){i.data.inited&&clearTimeout(i.data.inited.load_screen),h.wrap.style.visibility="visible",h.load_screen.style.display="none"}function J(){h.content.style.top=(h.top_menu&&"open"===h.top_menu.state?h.top_menu.getBoundingClientRect().height:h.content_bounds.top+(!h.top_menu||h.bottom_menu||h.right_menu&&("open"===h.right_menu.state||"open"===h.left_menu.state)?0:40))+"px",h.content.style.right=h.content_bounds.right+(h.right_menu&&"closed"!==h.right_menu.state?h.right_menu.getBoundingClientRect().width:0)+"px",h.content.style.bottom=h.content_bounds.bottom+(h.bottom_menu&&"closed"!==h.bottom_menu.state?h.bottom_menu.getBoundingClientRect().height:0)+"px",h.content.style.left=h.content_bounds.left+(h.left_menu&&"closed"!==h.left_menu.state?h.left_menu.getBoundingClientRect().width:0)+"px"}function V(){"undefined"==typeof module&&e.dispatchEvent(new Event("resize"))}function U(){var t,i,a="";for(t in v)Object.hasOwn(v,t)&&v[t].input&&!s.settings.test(t)&&""!==(i=v[t].value())&&null!=i&&"-1"!=i&&(a+=(a?"&":"?")+t+"="+i);return e.location.protocol+"//"+e.location.host+e.location.pathname+a}function W(){var e,n,d,c,m,u,f,b,_;for(e in p.dataset=i.metadata.datasets[0],v)if(Object.hasOwn(v,e)&&Object.hasOwn(l,v[e].type)){if((f=v[e]).options_source)if(s.palette.test(f.options_source)){for(_ in a)Object.hasOwn(a,_)&&f.add(_,a[_].name);f.options=f.e.getElementsByTagName("select"===f.type?"option":"input"),f.reset()}else if(s.datasets.test(f.options_source)){for(n=i.metadata.datasets.length;n--;)f.add(n,i.metadata.datasets[n],i.data.format_label(i.metadata.datasets[n]));f.options=f.e.getElementsByTagName("select"===f.type?"option":"input")}else f.option_sets={},_=X(f.dataset)||p.dataset,Object.hasOwn(i.metadata.info,_)&&(s.ids.test(f.options_source)?C(f,_,f.option_sets):s.variable.test(f.options_source)?x(f,_,f.option_sets):s.levels.test(f.options_source)&&Object.hasOwn(i.data.variables,f.variable)&&j(f,_,f.variable,f.option_sets)),f.depends&&T(f.depends,{type:"options",id:f.id}),Object.hasOwn(v,f.dataset)&&T(f.dataset,{type:"options",id:f.id}),f.view&&T(f.view,{type:"options",id:f.id});if("number"===f.type){if(f.min=f.e.getAttribute("min"),f.min_ref=parseFloat(f.min),f.max=f.e.getAttribute("max"),f.max_ref=parseFloat(f.max),f.ref=isNaN(f.min_ref)||isNaN(f.max_ref),f.range=[f.min_ref,f.max_ref],f.step=parseFloat(f.e.step)||1,f.parsed={min:void 0,max:void 0},f.depends={},f.update=function(){const e=v[this.view],t=X(f.variable||e.y);e.time_range||(e.time_range={time:[]});var a=e.get?e.get.dataset():X(this.dataset),n=X(this.min)||e.time,r=X(this.max)||e.time;s.minmax.test(n)&&(n=v[this.min][n]),s.minmax.test(r)&&(r=v[this.max][r]),this.parsed.min=isNaN(this.min_ref)?void 0===n?e.time_range.time[0]:"number"==typeof n?n:Object.hasOwn(i.data.variables,n)?i.data.variables[n].info[a||i.data.variables[n].datasets[0]].min:parseFloat(n):this.min_ref,this.parsed.max=isNaN(this.max_ref)?void 0===r?e.time_range.time[1]:"number"==typeof r?r:Object.hasOwn(i.data.variables,r)?i.data.variables[r].info[a||i.data.variables[r].datasets[0]].max:parseFloat(r):this.min_ref,this.ref&&Object.hasOwn(i.data.variables,t)?(this.range[0]=this.e.min=_=isNaN(this.min_ref)?Math.max(e.time_range.time[0],this.parsed.min):this.min_ref,this.range[1]=this.e.max=_=isNaN(this.max_ref)?Math.min(e.time_range.time[1],this.parsed.max):this.max_ref,this.depends[e.y]||(this.depends[e.y]=!0,T(e.y,{type:"update",id:this.id})),t!==this.variable&&this.reset(),i.data.variables[t][this.view].summaries[a]&&i.data.variables[t][this.view].summaries[a].filled&&(this.variable=t)):(this.e.min=this.parsed.min,(this.parsed.min>this.source||!this.source&&"min"===this.default)&&this.set(this.parsed.min),this.e.max=this.parsed.max,(this.parsed.max<this.source||!this.source&&"max"===this.default)&&this.set(this.parsed.max))}.bind(f),f.view&&T(f.view,{type:"update",id:f.id}),Object.hasOwn(i.data.variables,f.max)?f.view&&T(f.view+"_time",{type:"max",id:f.id}):Object.hasOwn(v,f.max)?T(f.max,{type:"max",id:f.id}):f.e.max=parseFloat(f.max),Object.hasOwn(i.data.variables,f.min)?f.view&&T(f.view+"_time",{type:"min",id:f.id}):Object.hasOwn(v,f.min)?T(f.min,{type:"min",id:f.id}):f.e.min=parseFloat(f.min),f.view||(f.view=p.dataview),void 0!==f.default&&(s.number.test(f.default)?f.default=Number(f.default):f.reset="max"===f.default||"last"===f.default?function(){this.range&&this.set(X(this.range[1]))}.bind(f):"min"===f.default||"first"===f.default?function(){this.range&&this.set(X(this.range[0]))}.bind(f):Object.hasOwn(v,this.default)?function(){this.set(X(this.default))}.bind(f):function(){}),f.variable){const e=-1===i.metadata.datasets.indexOf(f.dataset)?p.dataset:f.dataset;Object.hasOwn(v,f.variable)?T(f.variable,{type:"update",id:f.id}):Object.hasOwn(i.data.variables,f.variable)&&(f.e.min=f.min=f.parsed.min=f.range[0]=i.data.variables[f.variable].info[e].min,f.e.max=f.max=f.parsed.max=f.range[1]=i.data.variables[f.variable].info[e].max)}}else{if(!f.values.length)for(n=f.options.length;n--;)f.values[n]=f.options[n].value,f.display[n]=i.data.format_label(f.options[n].innerText.trim()||f.values[n]);if("checkbox"===f.type){if(f.source=[],f.current_index=[],f.default=f.default.split(","),f.options.length)for(n=f.options.length;n--;)f.values[n]=f.options[n].value}else f.values.length&&!Object.hasOwn(v,f.default)&&-1===f.values.indexOf(f.default)&&(f.default=parseInt(f.default),f.default=f.values.length>f.default?f.values[f.default]:"")}if("select"===f.type||"number"===f.type){if(f.e.addEventListener("input",f.listen),f.e.parentElement.lastElementChild&&f.e.parentElement.lastElementChild.classList.contains("select-reset")&&f.e.parentElement.lastElementChild.addEventListener("click",f.reset),Object.hasOwn(i,f.type)&&Object.hasOwn(i[f.type],f.id)){for(m in f.filters=i[f.type][f.id],f.current_filter={},f.filters)Object.hasOwn(v,f.filters[m])&&T(f.filters[m],{type:"filter",id:f.id});f.filter=function(){var e,t,a,s;for(e in this.filters)Object.hasOwn(this.filters,e)&&(this.current_filter[e]=X(this.filters[e]));for(t=this.values.length;t--;){if(a=!1,Object.hasOwn(i.data.variables,this.values[t])&&Object.hasOwn(i.data.variables[this.values[t]],"meta"))for(e in this.current_filter)if(Object.hasOwn(i.data.variables[this.values[t]].meta,e)&&!(a=i.data.variables[this.values[t]].meta[e]===this.current_filter[e]))break;a&&(s=this.values[t]),this.options[t].classList[a?"remove":"add"]("hidden")}this.current_index=this.values.indexOf(this.value()),s&&(-1===this.current_index||this.options[this.current_index].classList.contains("hidden"))&&this.set(s)}.bind(f)}}else if("switch"===f.type)"boolean"!=typeof f.default&&(f.default=f.e.checked),f.e.addEventListener("change",f.listen);else for(n=f.options.length;n--;)f.options[n].addEventListener("click",f.listen);s.settings.test(f.id)&&(f.setting=f.id.replace(s.settings,""),null==f.default&&Object.hasOwn(i.settings,f.setting)&&(f.default=i.settings[f.setting]),T(f.id,{type:"setting",id:f.id})),(_=i.url_options[f.id]||o.getItem(f.id.replace(s.settings,"")))?(s.bool.test(_)&&(_="true"===_),f.set(_)):f.reset&&f.reset()}for(e in i.dataviews)if(Object.hasOwn(i.dataviews,e)){for(b in v[e]=d=i.dataviews[e],d.id=e,d.value=function(){if(this.get)return this.reparse(),""+this.parsed.dataset+this.parsed.ids+this.parsed.features+this.parsed.variables+i.settings.summary_selection}.bind(d),"string"==typeof d.palette&&Object.hasOwn(v,d.palette)&&T(d.palette,{type:"dataview",id:e}),"string"==typeof d.dataset&&Object.hasOwn(v,d.dataset)&&T(d.dataset,{type:"dataview",id:e}),"string"==typeof d.ids&&Object.hasOwn(v,d.ids)&&T(d.ids,{type:"dataview",id:e}),d.time_range={variable:"",index:[],time:[],filtered:[]},T(e,{type:"time_range",id:e}),Object.hasOwn(v,d.x)&&T(d.x,{type:"time_range",id:e}),Object.hasOwn(v,d.y)&&T(d.y,{type:"time_range",id:e}),d.features)Object.hasOwn(d.features,b)&&"string"==typeof d.features[b]&&Object.hasOwn(v,d.features[b])&&T(d.features[b],{type:"dataview",id:e});if(d.variables)for(n=d.variables.length;n--;)Object.hasOwn(d.variables[n],"variable")?Object.hasOwn(v,d.variables[n].variable)&&T(d.variables[n].variable,{type:"dataview",id:e}):d.variables.splice(n,1),Object.hasOwn(d.variables[n],"type")?Object.hasOwn(v,d.variables[n].type)&&T(d.variables[n].type,{type:"dataview",id:e}):d.variables[n].type="=",Object.hasOwn(d.variables[n],"value")?Object.hasOwn(v,d.variables[n].value)&&T(d.variables[n].value,{type:"dataview",id:e}):d.variables[n].value=0;ie(d),r.dataview(d),d.reparse()}for(n=(m=t.getElementsByClassName("auto-output")).length,u=0;n--;){if(d=m[n],(f={type:d.getAttribute("auto-type"),view:d.getAttribute("data-view")||p.dataview,id:d.id||"out"+u++,note:d.getAttribute("aria-description")||"",reference_options:{},e:d}).note&&f.e.addEventListener("mouseover",Y.bind(f)),f.options=Object.hasOwn(i,f.type)?i[f.type][f.id]:void 0,Object.hasOwn(l,f.type)&&Object.hasOwn(l[f.type],"update")&&(f.update=l[f.type].update.bind(f)),f.options){for(e in Object.hasOwn(f.options,"options")&&(f.options=f.options.options),f.options)Object.hasOwn(v,f.options[e])&&(f.reference_options[e]=f.options[e]);if(Object.hasOwn(f.options,"subto"))for("string"==typeof f.options.subto&&(f.options.subto=[f.options.subto]),_=f.options.subto.length;_--;)N(f.options.subto[_],f)}v[f.id]=f,f.view&&(Object.hasOwn(g,f.view)||(g[f.view]=[]),Object.hasOwn(g,f.view+"_filter")||(g[f.view+"_filter"]=[])),Object.hasOwn(l,f.type)&&Object.hasOwn(l[f.type],"init")&&(!f.view||Object.hasOwn(i.data.inited,v[f.view].parsed.dataset)?l[f.type].init(f):(i.data.data_queue[v[f.view].parsed.dataset][f.id]=l[f.type].init.bind(null,f),i.data.loaded[v[f.view].parsed.dataset]&&i.data.load_id_maps()))}(d=h.modal.filter).body.appendChild(d.variable_filters=t.createElement("div")),d.variable_filters.appendChild(t.createElement("p")),d.variable_filters.lastElementChild.className="h6 text-muted",d.variable_filters.lastElementChild.innerText="Variable Conditions",d.variable_filters.appendChild(c=t.createElement("div")),c.className="row",c.appendChild(t.createElement("div")),c.lastElementChild.className="col",c.lastElementChild.appendChild(m=t.createElement("div")),m.className="dropdown",m.appendChild(t.createElement("button")),m.lastElementChild.type="button",m.lastElementChild.id="filter_variable_dropdown",m.lastElementChild.className="btn dropdown-toggle",m.lastElementChild.setAttribute("data-bs-toggle","dropdown"),m.lastElementChild.setAttribute("aria-expanded",!1),m.lastElementChild.innerText="Add Variable Condition",m.appendChild(t.createElement("ul")),m.lastElementChild.addEventListener("click",function(e){if("A"===e.target.tagName){const l=t.createElement("div");var a,s;i.data.filter||(i.data.filter=new Map),l.setAttribute("index",i.data.filter.size),i.data.filter.set(i.data.filter.size,s={e:l,index:i.data.filter.size,variable:e.target.value,component:"selected",operator:">=",value:""}),l.className="row",l.appendChild(t.createElement("div")),l.lastElementChild.className="col",l.lastElementChild.appendChild(a=t.createElement("p")),a.className="cell-text",a.innerText=e.target.innerText,l.appendChild(t.createElement("div")),l.lastElementChild.style.maxWidth="140px",l.lastElementChild.className="col",l.lastElementChild.appendChild(a=t.createElement("select")),a.className="form-select",a.default="0",a.addEventListener("change",(e=>{s.component=e.target.selectedOptions[0].value,r.dataview()}));var n=["selected"];n.forEach((e=>{a.appendChild(t.createElement("option")),a.lastElementChild.component=a.lastElementChild.innerText=e,r.dataview()})),l.appendChild(t.createElement("div")),l.lastElementChild.style.maxWidth="95px",l.lastElementChild.className="col",l.lastElementChild.appendChild(a=t.createElement("select")),a.className="form-select",a.default="0",a.addEventListener("change",(e=>{s.operator=e.target.selectedOptions[0].value,r.dataview()})),(n=[">=","<="]).forEach((e=>{a.appendChild(t.createElement("option")),a.lastElementChild.value=a.lastElementChild.innerText=e,r.dataview()})),l.appendChild(t.createElement("div")),l.lastElementChild.className="col-2",l.lastElementChild.appendChild(a=t.createElement("input")),a.className="form-control",a.type="number",a.addEventListener("change",(e=>{s.value=e.target.value,r.dataview()})),l.appendChild(t.createElement("div")),l.lastElementChild.style.maxWidth="36px",l.lastElementChild.className="col",l.lastElementChild.appendChild(a=t.createElement("button")),a.className="btn btn-close",a.type="button",a.addEventListener("click",function(){this.e.parentElement.removeChild(this.e),i.data.filter.delete(this.index),r.dataview()}.bind(s)),h.modal.filter.variable_filters.lastElementChild.appendChild(l)}}.bind(d)),m.lastElementChild.className="dropdown-menu",m.lastElementChild.setAttribute("aria-labelledby","filter_variable_dropdown"),Object.keys(i.data.variables).forEach((e=>{if("time"!==e){const a=t.createElement("li");a.appendChild(t.createElement("a")),a.lastElementChild.className="dropdown-item",a.lastElementChild.href="#",a.lastElementChild.value=e,a.lastElementChild.innerText=i.data.variable_info[e]&&i.data.variable_info[e].short_name||e,m.lastElementChild.appendChild(a)}})),d.variable_filters.appendChild(t.createElement("div")),d.variable_filters.lastElementChild.className="row"}function X(e){return(e="string"==typeof e&&Object.hasOwn(v,e)?v[e]:e)&&e.value&&(e=X(e.value())),e}function Y(){if(i.settings.hide_tooltips||this.id===h.tooltip.showing)return;h.tooltip.showing=this.id,h.tooltip.e.firstElementChild.innerText=this.note,h.tooltip.e.classList.remove("hidden");const e=h.wrap.getBoundingClientRect(),t=this.wrapper.getBoundingClientRect(),a=h.tooltip.e.getBoundingClientRect();h.tooltip.e.style.left=Math.max(0,Math.min(t.x,t.x+t.width/2-a.width/2))+"px",h.tooltip.e.style.top=t.y+(t.y<e.height/2?t.height+5:-a.height-5)+"px"}function Q(e){!h.tooltip.showing||"blur"!==e.type&&h.tooltip.showing===(e.target.getAttribute("of")||e.target.id)||(h.tooltip.showing="",h.tooltip.e.classList.add("hidden"))}function K(e,t){t.on({mouseover:l.map.mouseover.bind(this),mouseout:l.map.mouseout.bind(this),click:l.map.click.bind(this)})}async function Z(t,a,s){if(Object.hasOwn(i.map._raw,a.url))ee(a,t),i.map._queue[a.name+(a.time?a.time:"")].retrieved=!0,s&&s();else{const n=new e.XMLHttpRequest;n.onreadystatechange=function(e){4===n.readyState&&200===n.status&&(i.map._raw[a.url]=n.responseText,a.name&&(i.map._queue[a.name+(a.time?a.time:"")].retrieved=!0,ee(this,e)),s&&s())}.bind(a,t),n.open("GET",a.url,!0),n.send()}}function ee(e,t){var a,n,r;const l=Object.hasOwn(e,"time"),d=e.name+(l?e.time:"");if(i.map[t.id]._layers[d]=L.geoJSON(JSON.parse(i.map._raw[e.url]),{onEachFeature:K.bind(t)}),i.data.inited[d+t.id]=!0,i.map[t.id]._layers[d].eachLayer((d=>{if(d.setStyle({weight:0,fillOpacity:0}),d.source=e,a=d.feature.properties,r=a[e.id_property],!Object.hasOwn(i.data.entities,r)&&s.leading_zeros.test(r)&&(r=a[e.id_property]=r.replace(s.leading_zeros,"")),Object.hasOwn(i.data.entities,r)?Object.hasOwn(i.data.entities[r],"layer")||(i.data.entities[r].layer={}):i.data.entities[r]={layer:{},features:{id:r}},l?(Object.hasOwn(i.data.entities[r].layer,t.id)||(i.data.entities[r].layer[t.id]={has_time:!0}),i.data.entities[r].layer[t.id][e.time]=d):i.data.entities[r].layer[t.id]=d,d.entity=i.data.entities[r],i.data.entities[r].features)for(n in a)Object.hasOwn(a,n)&&!Object.hasOwn(i.data.entities[r].features,n)&&("name"!==n.toLowerCase()||Object.hasOwn(i.data.entities[r].features,"name")&&i.data.entities[r].features.id!==i.data.entities[r].features.name?i.data.entities[r].features[n]=a[n]:i.data.entities[r].features[n.toLowerCase()]=a[n])})),i.map._waiting&&i.map._waiting[e.name])for(var o=i.map._waiting[e.name].length;o--;)le(i.map._waiting[e.name][o])}function te(e,a,s){var n,r="string"==typeof a.source?a.source:"";if(!r&&void 0!==s&&a.source)for(n=a.source.length;n--;)if(s===a.source[n].time){r=a.source[n].url;break}if(r){if(!Object.hasOwn(i.map._raw,r))return Z(e,a.source[n],te.bind(null,e,a,s));Object.hasOwn(i.map[e.id]._layers,r)||(i.map[e.id]._layers[r]=L.geoJSON(JSON.parse(i.map._raw[r]),{pointToLayer:(e,t)=>L.circleMarker(t),onEachFeature:(e,i)=>{const a=t.createElement("table");Object.keys(e.properties).forEach((i=>{const s=t.createElement("tr");s.appendChild(t.createElement("td")),s.appendChild(t.createElement("td")),s.firstElementChild.innerText=i,s.lastElementChild.innerText=e.properties[i],a.appendChild(s)})),i.bindTooltip(a)}})),e.overlay.clearLayers(),i.map[e.id]._layers[r].eachLayer((t=>{if(a.filter)for(var s=a.filter.length;s--;)if(!a.filter[s].check(t.feature.properties[a.filter[s].feature],a.filter[s].value))return;t.setRadius(i.settings.circle_radius||p.circle_radius).setStyle({weight:i.settings.polygon_outline||p.polygon_outline,color:"white",opacity:.5,fillOpacity:.5,fillColor:"black"}),t.addTo(e.overlay)})),e.overlay_control.addTo(e.map)}}function ie(e){var t;if(e.times=[],e.time_filters)for(e.time_filters=[{variable:p.time,type:">=",value:"filter.time_min"},{variable:p.time,type:"<=",value:"filter.time_max"}],T(e.id+"_time",{type:"min",id:"filter.time_min"}),T(e.id+"_time",{type:"max",id:"filter.time_max"}),t=e.time_filters.length;t--;)Object.hasOwn(v,e.time_filters[t].value)&&T(e.time_filters[t].value,{type:"time_filters",id:e.id});e.selection={ids:{},features:{},variables:[],dataset:{},filtered:{},all:{}},e.n_selected={ids:0,features:0,variables:0,dataset:0,filtered:0,all:0},e.get={dataset:function(){return X("string"==typeof e.dataset&&Object.hasOwn(v,e.dataset)?v[e.dataset].value():e.dataset)||p.dataset},ids:function(){return X("string"==typeof e.ids&&Object.hasOwn(v,e.ids)?v[e.ids].value():e.ids)},features:function(){var t,i="";if(e.features)for(t in e.features)Object.hasOwn(e.features,t)&&(i+=t+X(e.features[t]));return i},variables:function(){if(e.variables||i.data.filter&&i.data.filter.size){e.parsed.variable_values.length||e.reparse();for(var t="",a=e.parsed.variable_values.length;a--;)t+=e.parsed.variable_values[a].name+e.parsed.variable_values[a].operator+e.parsed.variable_values[a].value;return t}return""},time_filters:function(){var i="";if(e.time_filters&&e.time_filters.length)for(t=e.time_filters.length;t--;)i+=Object.hasOwn(v,e.time_filters[t].value)?X(e.time_filters[t].value):e.time_filters[t].value;return i}},e.ids_check="object"==typeof e.get.ids()?DataHandler.prototype.checks.includes:function(e,t){return!e||-1==e||e===t||t&&e.length>2&&e===String(t).substring(0,e.length)},e.parsed={dataset:"",ids:"",features:"",variables:"",time_filters:"",time_agg:0,id_source:"",variable_values:[],feature_values:{}},e.reparse=function(){if(this.parsed.dataset=this.get.dataset(),this.parsed.ids=this.get.ids(),this.parsed.time_filters=this.get.time_filters(),this.parsed.time_agg=Object.hasOwn(i.data.meta.times,this.parsed.dataset)?X(this.time_agg)-i.data.meta.times[this.parsed.dataset].range[0]:0,"string"==typeof this.ids&&Object.hasOwn(v,this.ids)&&("virtual"===v[this.ids].type&&Object.hasOwn(v,v[this.ids].source)||Object.hasOwn(v[this.ids],"depends")&&Object.hasOwn(v,v[this.ids].depends))&&(this.parsed.id_source="virtual"===v[this.ids].type?X(v[v[this.ids].source].dataset):v[v[this.ids].depends].value()),this.features){for(var e in this.parsed.feature_values={},this.features)Object.hasOwn(this.features,e)&&(this.parsed.feature_values[e]={value:X(this.features[e])},this.parsed.feature_values[e].operator="string"==typeof this.parsed.feature_values[e].value?"equals":"includes");this.parsed.features=this.get.features()}else this.parsed.features="";if(this.parsed.variable_values=[],i.data.filter&&i.data.filter.size&&i.data.filter.forEach((e=>{const t=Number(e.value);isNaN(t)||this.parsed.variable_values.push({name:e.variable,operator:e.operator,value:t,value_type:"number"})})),this.variables||this.parsed.variable_values.length){if(this.variables)for(var t,a=this.variables.length;a--;)t=X(this.variables[a].value),this.parsed.variable_values.push({name:X(this.variables[a].variable),operator:X(this.variables[a].type),value:t,value_type:typeof t});this.parsed.variables=this.get.variables()}else this.parsed.variables=""}.bind(e),e.checks={dataset:function(e){return this.parsed.dataset===e.group}.bind(e),ids:("string"==typeof e.ids&&Object.hasOwn(v,e.ids)&&("virtual"===v[e.ids].type&&Object.hasOwn(v,v[e.ids].source)||Object.hasOwn(v[e.ids],"depends")&&Object.hasOwn(v,v[e.ids].depends))?"virtual"===v[e.ids].type?function(e){return e.features&&this.ids_check(this.parsed.ids,e.features[this.parsed.id_source&&e.group!==this.parsed.id_source&&Object.hasOwn(e.features,this.parsed.id_source)?this.parsed.id_source:"id"])}:function(e){return e.features&&this.ids_check(this.parsed.ids,Object.hasOwn(e.features,this.parsed.id_source)?X(e.features[this.parsed.id_source]):e.features.id)}:function(e){return e.features&&this.ids_check(this.parsed.ids,e.features.id)}).bind(e),features:function(e){if(e.features){var t,i,a=!0;for(t in this.parsed.feature_values)if(Object.hasOwn(this.parsed.feature_values,t)&&(i=this.parsed.feature_values[t],!(a=DataHandler.prototype.checks[i.operator](i.value,X(e.features[t])))))break;return a}return!0}.bind(e),variables:function(e){if(e.data){for(var t,a,s=this.parsed.variable_values.length,n=!0;s--&&(t=this.parsed.variable_values[s],a=e.get_value(t.name,this.parsed.time_agg-i.data.variables[t.name].time_range[this.parsed.dataset][0]),n=isNaN(a)||t.value_type!==typeof a||DataHandler.prototype.checks[t.operator](a,t.value)););return n}return!0}.bind(e)},e.check=function(e){return{ids:!this.ids||this.checks.ids(e),features:!this.features||this.checks.features(e),variables:!this.variables&&(!i.data.filter||!i.data.filter.size)||this.checks.variables(e),dataset:!this.dataset||this.checks.dataset(e)}}.bind(e)}function ae(){e.localStorage&&e.localStorage.clear(),e.location.reload()}function se(){const e=v[this.view],t=i.data.variable_info[X(this.v||e.y)];var a,s;if(h.modal.info.header.firstElementChild.innerText=t.short_name,h.modal.info.title.innerText=t.long_name,h.modal.info.description.innerText=t.long_description||t.description||t.short_description||"",h.modal.info.name.lastElementChild.innerText=t.measure||"",h.modal.info.type.lastElementChild.innerText=t.type||"",t.sources&&t.sources.length)for(h.modal.info.sources.lastElementChild.lastElementChild.innerHTML="",h.modal.info.sources.classList.remove("hidden"),a=t.sources.length,s=0;s<a;s++)h.modal.info.sources.lastElementChild.lastElementChild.appendChild(q(t.sources[s]));else h.modal.info.sources.classList.add("hidden");if(t.citations&&t.citations.length&&"string"!=typeof t.citations)for(h.modal.info.references.lastElementChild.innerHTML="",h.modal.info.references.classList.remove("hidden"),"string"==typeof t.citations&&(t.citations=[t.citations]),a=t.citations.length,s=0;s<a;s++)i.data.variable_info._references&&Object.hasOwn(i.data.variable_info._references,t.citations[s])&&h.modal.info.references.lastElementChild.appendChild(i.data.variable_info._references[t.citations[s]].element);else h.modal.info.references.classList.add("hidden")}function ne(){for(var e in u.retain_state=!1,v)Object.hasOwn(v,e)&&le(e)}function re(){for(var e in u.retain_state=!1,v)Object.hasOwn(v,e)&&!v[e].setting&&v[e].reset&&(v[e].reset(),le(e))}function le(e){c[e]=!0,clearTimeout(c._timeout),c._timeout=setTimeout(de,20),u.lock_after=e}function de(){var t,a,n;for(t in clearTimeout(c._timeout),c)if("_timeout"!==t&&Object.hasOwn(c,t)&&c[t]){if(n=oe(t))return i.data.data_queue[n][t]=de,i.data.loaded[n]&&i.data.load_id_maps(),!1;c[t]=!1}if(t=U(),i.data.inited.first&&t!==i.state){for(a in i.state=t,i.url_options)Object.hasOwn(i.url_options,a)&&s.embed_setting.test(a)&&(t+="&"+a+"="+("navcolor"===a?i.url_options[a].replace(s.hashes,"%23"):i.url_options[a]));i.settings.hide_url_parameters||e.history.replaceState(Date.now(),"",t),setTimeout(J,50)}}function oe(e){if(Object.hasOwn(g,e)){var t,a,s,n,l,d,o=v[e],h=g[e],c=[],p=o&&o.value()+"",m=o&&o.dataset&&X(o.dataset)||p;if(o&&(!u.retain_state||o.state!==p)){if(m in i.metadata.info&&!i.data.loaded[m])return i.data.retrieve(m,i.metadata.info[m].site_file),m;for(o.state=p,t=h.length;t--;)"rule"===h[t].type?-1===c.indexOf(h[t].rule)&&c.push(i.rules[h[t].rule]):"function"==typeof v[h[t].id][h[t].type]?v[h[t].id][h[t].type]():r[h[t].type](v[h[t].id],o);for(t=c.length;t--;){for(s=c[t].condition.length,a=0;a<s&&(n=c[t].condition[a].check(),c[t].condition[a].any?!n:n);a++);for(l in c[t].effects)if(n)"display"===l?c[t].effects[l].e.classList.remove("hidden"):Object.hasOwn(v,l)&&v[l].set(X(c[t].effects[l]));else if("display"===l)for(c[t].effects[l].e.classList.add("hidden"),c[t].effects[l].u&&c[t].effects[l].u.reset(),a=(d=c[t].effects[l].e.getElementsByClassName("auto-input")).length;a--;)Object.hasOwn(v,d[a].id)&&v[d[a].id].reset();else Object.hasOwn(c[t],"default")&&Object.hasOwn(v,l)&&v[l].set(X(c[t].default))}e===u.lock_after&&(u.retain_state=!0)}}}function he(){const t=this.deferred||!this.tab||this.tab.classList.contains("show");t&&e.Plotly?(Plotly.newPlot(this.e,this.options),this.e.on("plotly_hover",l.plotly.mouseover.bind(this)).on("plotly_unhover",l.plotly.mouseout.bind(this)).on("plotly_click",l.plotly.click.bind(this)),B(this),this.update()):(this.deferred=!0,setTimeout(he.bind(this),t?0:2e3))}function ce(){const t=i.settings.theme_dark?"dark":"light",a=this.deferred||!this.tab||this.tab.classList.contains("show");var s,n,r,l,d;if(a&&e.L){if(this.map=L.map(this.e,this.options),this.options=this.map.options,this.overlay=L.featureGroup().addTo(this.map),this.displaying=L.featureGroup().addTo(this.map),this.overlay_control=L.control.layers().setPosition("topleft").addOverlay(this.overlay,"Overlay").addTo(this.map),this.tiles={},Object.hasOwn(i.map,this.id)){if(i.map[this.id].u=this,i.map[this.id].tiles)if(i.map[this.id].tiles.url)this.tiles[t]=L.tileLayer(i.map[this.id].tiles.url,i.map[this.id].tiles.options),this.tiles[t].addTo(this.map);else for(s in i.map[this.id].tiles)Object.hasOwn(i.map[this.id].tiles,s)&&(this.tiles[s]=L.tileLayer(i.map[this.id].tiles[s].url,i.map[this.id].tiles[s].options),t===s&&this.tiles[s].addTo(this.map));for(Object.hasOwn(i.map,"_raw")||(i.map._raw={}),Object.hasOwn(i.map,"_queue")||(i.map._queue={}),Object.hasOwn(i.map[this.id],"_layers")||(i.map[this.id]._layers={}),n=i.map[this.id].shapes.length;n--;)l=Object.hasOwn(i.map[this.id].shapes[n],"time"),!i.map[this.id].has_time&&l&&(i.map[this.id].has_time=!0,T(this.view,{type:"update",id:this.id}),i.map[this.id].match_time="exact"===i.map[this.id].shapes[n].resolution?e=>e+"":e=>String(e).substring(0,3)+"0"),(s=i.map[this.id].shapes[n].name)||(i.map[this.id].shapes[n].name=s=i.metadata.datasets[n<i.metadata.datasets.length?n:0]),d=s+(l?i.map[this.id].shapes[n].time:""),i.map._queue[d]=i.map[this.id].shapes[n],i.data.inited[d+this.id]=!1,!i.data.loaded[s]||s!==d&&i.map[this.id].shapes[n].time!=i.map[this.id].match_time(i.data.meta.overall.value[v[this.view].parsed.time_agg])||Z(this,i.map[this.id].shapes[n]);if(i.map[this.id].triggers={},i.map[this.id].overlays)for(n=i.map[this.id].overlays.length;n--;){"string"==typeof i.map[this.id].overlays[n].source&&(i.map[this.id].overlays[n].source=[{url:i.map[this.id].overlays[n].source}]);const e=i.map[this.id].overlays[n].source;e.forEach((e=>{e.retrieved=Object.hasOwn(i.map._raw,e.url),i.map._queue[e.url]=e})),i.map[this.id].triggers[i.map[this.id].overlays[n].variable]={source:e};const t=i.map[this.id].overlays[n].filter;if(t){const e=Array.isArray(t)?t:[t];for(i.map[this.id].triggers[i.map[this.id].overlays[n].variable].filter=e,r=e.length;r--;)e[r].check=i.data.checks[e[r].operator]}}}}else this.deferred=!0,setTimeout(ce.bind(this),a?0:2e3)}function pe(){const t=this.deferred||!this.tab||this.tab.classList.contains("show");t&&e.jQuery&&e.DataTable&&Object.hasOwn(i.dataviews[this.view],"get")?(this.options.columns=this.header,this.table=$(this.e).DataTable(this.options),this.update()):(this.deferred=!0,setTimeout(pe.bind(this),t?0:2e3))}e.onload=function(){var a,r,d,o,c,m,u,f;for(h.navbar=t.getElementsByClassName("navbar")[0],h.navbar=h.navbar?h.navbar.getBoundingClientRect():{height:0},h.content=t.getElementsByClassName("content")[0],h.menus=t.getElementsByClassName("menu-wrapper"),h.panels=t.getElementsByClassName("panel"),h.content_bounds={top:h.navbar.height,right:0,bottom:0,left:0},h.script_style=t.head.appendChild(t.createElement("style")),i.settings.hide_tooltips&&h.script_style.sheet.insertRule(n,0),h.menu_toggler={hide:function(){this.classList.add("hidden"),V()},toggle:function(e){clearTimeout(h.menu_toggler.timeout),"closed"===this.parentElement.state?(this.parentElement.state="open",this.parentElement.firstElementChild.classList.remove("hidden"),this.parentElement.style[e]="0px",h.content.style[e]=this.parentElement.getBoundingClientRect()["left"===e||"right"===e?"width":"height"]+"px",setTimeout(V,300)):(this.parentElement.state="closed","left"===e||"right"===e?(this.parentElement.style[e]=-this.parentElement.getBoundingClientRect().width+"px",h.content.style[e]=h.content_bounds[e]+"px"):(h.content.style[e]=h.content_bounds[e]+("top"===e?h.content_bounds.top:0)+"px",this.parentElement.style[e]=-this.parentElement.getBoundingClientRect().height+("top"===e?h.content_bounds.top:0)+"px"),h.menu_toggler.timeout=setTimeout(h.menu_toggler.hide.bind(this.parentElement.firstElementChild),300))},timeout:-1},h.modal={info:{init:!1,e:t.createElement("div")},filter:{init:!1,e:t.createElement("div")}},h.load_screen=t.getElementById("load_screen"),d=h.modal.info.e,t.body.appendChild(d),h.modal.info.init=!0,d.id="variable_info_display",d.className="modal fade",d.setAttribute("tabindex","-1"),d.setAttribute("aria-labelledby","variable_info_title"),d.ariaHidden="true",d.appendChild(t.createElement("div")),d.firstElementChild.className="modal-dialog modal-dialog-scrollable",d.firstElementChild.appendChild(t.createElement("div")),d.firstElementChild.firstElementChild.className="modal-content",d.firstElementChild.firstElementChild.appendChild(h.modal.info.header=t.createElement("div")),(d=h.modal.info).header.className="modal-header",d.header.appendChild(t.createElement("p")),d.header.firstElementChild.className="h5 modal-title",d.header.firstElementChild.id="variable_info_title",d.header.appendChild(t.createElement("button")),d.header.lastElementChild.type="button",d.header.lastElementChild.className="btn-close",d.header.lastElementChild.setAttribute("data-bs-dismiss","modal"),d.header.lastElementChild.title="close",d.header.insertAdjacentElement("afterEnd",d.body=t.createElement("div")),d.body.className="modal-body",d.body.appendChild(d.title=t.createElement("p")),d.title.className="h4",d.body.appendChild(d.description=t.createElement("p")),d.body.appendChild(t.createElement("table")),d.body.lastElementChild.className="info-feature-table",d.body.lastElementChild.appendChild(d.name=t.createElement("tr")),d.name.appendChild(t.createElement("td")),d.name.firstElementChild.innerText="Name",d.name.appendChild(t.createElement("td")),d.body.lastElementChild.appendChild(d.type=t.createElement("tr")),d.type.appendChild(t.createElement("td")),d.type.firstElementChild.innerText="Type",d.type.appendChild(t.createElement("td")),d.body.appendChild(d.sources=t.createElement("div")),d.sources.appendChild(d=t.createElement("table")),d.className="source-table",d.appendChild(t.createElement("thead")),d.firstElementChild.appendChild(t.createElement("tr")),d.firstElementChild.firstElementChild.appendChild(t.createElement("th")),d.firstElementChild.firstElementChild.appendChild(t.createElement("th")),d.firstElementChild.firstElementChild.firstElementChild.innerText="Source",d.firstElementChild.firstElementChild.lastElementChild.innerText="Accessed",d.appendChild(t.createElement("tbody")),(d=h.modal.info).body.appendChild(d.references=t.createElement("div")),d.references.appendChild(t.createElement("p")),d.references.firstElementChild.className="h3",d.references.firstElementChild.innerText="References",d.references.appendChild(d=t.createElement("ul")),d.className="reference-list",t.body.appendChild(d=h.modal.filter.e),h.modal.filter.init=!0,d.id="filter_display",d.className="modal fade",d.setAttribute("tabindex","-1"),d.setAttribute("aria-labelledby","filter_title"),d.ariaHidden="true",d.appendChild(t.createElement("div")),d.firstElementChild.className="modal-dialog",d.firstElementChild.appendChild(t.createElement("div")),d.firstElementChild.firstElementChild.className="modal-content",d.firstElementChild.firstElementChild.appendChild(h.modal.filter.header=t.createElement("div")),(d=h.modal.filter).header.className="modal-header",d.header.appendChild(t.createElement("p")),d.header.firstElementChild.className="h5 modal-title",d.header.firstElementChild.id="filter_title",d.header.firstElementChild.innerText="Filter",d.header.appendChild(t.createElement("button")),d.header.lastElementChild.type="button",d.header.lastElementChild.className="btn-close",d.header.lastElementChild.setAttribute("data-bs-dismiss","modal"),d.header.lastElementChild.title="close",d.header.insertAdjacentElement("afterEnd",d.body=t.createElement("div")),d.body.className="modal-body",d.body.appendChild(t.createElement("p")),d.body.lastElementChild.className="h6 text-muted",d.body.lastElementChild.innerText="Time Range",d.body.appendChild(d.time_range=t.createElement("div")),d.time_range.className="row",d.time_range.appendChild(t.createElement("div")),d.time_range.lastElementChild.className="col",d.time_range.lastElementChild.appendChild(D=t.createElement("div")),D.className="form-floating text-wrapper wrapper",D.appendChild(t.createElement("input")),D.lastElementChild.className="form-control auto-input",D.lastElementChild.setAttribute("auto-type","number"),D.lastElementChild.setAttribute("default","min"),D.lastElementChild.max="filter.time_max",D.lastElementChild.type="number",D.lastElementChild.autoType="number",D.lastElementChild.id="filter.time_min",D.appendChild(t.createElement("label")),D.lastElementChild.innerText="First Time",D.lastElementChild.setAttribute("for","filter.time_min"),d.time_range.appendChild(t.createElement("div")),d.time_range.lastElementChild.className="col",d.time_range.lastElementChild.appendChild(D=t.createElement("div")),D.className="form-floating text-wrapper wrapper",D.appendChild(t.createElement("input")),D.lastElementChild.className="form-control auto-input",D.lastElementChild.setAttribute("auto-type","number"),D.lastElementChild.setAttribute("default","max"),D.lastElementChild.min="filter.time_min",D.lastElementChild.type="number",D.lastElementChild.autoType="number",D.lastElementChild.id="filter.time_max",D.appendChild(t.createElement("label")),D.lastElementChild.innerText="Last Time",D.lastElementChild.setAttribute("for","filter.time_max"),r=h.panels.length;r--;)h.content_bounds[h.panels[r].classList.contains("panel-left")?"left":"right"]=h.panels[r].getBoundingClientRect().width,h.panels[r].style.marginTop=h.content_bounds.top+"px";for(r=h.menus.length;r--;)h.menus[r].state=h.menus[r].getAttribute("state"),h.menus[r].classList.contains("menu-top")?(h.top_menu=h.menus[r],h.top_menu.style.left=h.content_bounds.left+"px",h.top_menu.style.right=h.content_bounds.right+"px","BUTTON"===h.menus[r].lastElementChild.tagName&&(h.menus[r].lastElementChild.addEventListener("click",h.menu_toggler.toggle.bind(h.menus[r].lastElementChild,"top")),h.menus[r].lastElementChild.style.top=h.content_bounds.top+"px")):h.menus[r].classList.contains("menu-right")?(h.right_menu=h.menus[r],h.right_menu.style.right=h.content_bounds.right+"px","BUTTON"===h.menus[r].lastElementChild.tagName&&(h.menus[r].lastElementChild.addEventListener("click",h.menu_toggler.toggle.bind(h.menus[r].lastElementChild,"right")),h.menus[r].lastElementChild.style.top=h.content_bounds.top+"px")):h.menus[r].classList.contains("menu-bottom")?(h.bottom_menu=h.menus[r],h.content_bounds.bottom=40,h.bottom_menu.style.left=h.content_bounds.left+"px",h.bottom_menu.style.right=h.content_bounds.right+"px","BUTTON"===h.menus[r].lastElementChild.tagName&&h.menus[r].lastElementChild.addEventListener("click",h.menu_toggler.toggle.bind(h.menus[r].lastElementChild,"bottom"))):h.menus[r].classList.contains("menu-left")&&(h.left_menu=h.menus[r],h.left_menu.style.left=h.content_bounds.left+"px","BUTTON"===h.menus[r].lastElementChild.tagName&&(h.menus[r].lastElementChild.addEventListener("click",h.menu_toggler.toggle.bind(h.menus[r].lastElementChild,"left")),h.menus[r].lastElementChild.style.top=h.content_bounds.top+"px")),i.url_options.close_menus&&"open"===h.menus[r].state&&h.menus[r].lastElementChild.click();if(h.tooltip={e:t.createElement("div"),showing:""},h.tooltip.e.className="tooltip hidden",h.tooltip.e.appendChild(t.createElement("p")),h.wrap.appendChild(h.tooltip.e),h.wrap.addEventListener("mouseover",Q),i.dataviews){for(a in i.dataviews)if(Object.hasOwn(i.dataviews,a)){p.dataview=a;break}}else i.dataviews={},i.dataviews[p.dataview]={dataset:p.dataset};for(r=(o=t.getElementsByClassName("auto-input")).length,u=0;r--;){if(f={type:(d=o[r]).getAttribute("auto-type"),source:void 0,value:function(){const e=X(this.source);return void 0===e?X(this.default):e},default:d.getAttribute("default"),options_source:d.getAttribute("auto-options"),depends:d.getAttribute("depends"),variable:d.getAttribute("variable"),dataset:d.getAttribute("dataset")||p.dataset,view:d.getAttribute("data-view"),id:d.id||d.options_source||"ui"+u++,note:d.getAttribute("aria-description")||"",current_index:-1,previous:"",e:d,values:[],display:[],data:[],input:!0},f.settings=Object.hasOwn(i,f.type)&&Object.hasOwn(i[f.type],f.id)?i[f.type][f.id]:{},f.wrapper=f.e.parentElement.classList.contains("wrapper")?f.e.parentElement:f.e.parentElement.parentElement,f.wrapper){for(f.note&&f.wrapper.classList.add("has-note"),f.wrapper.setAttribute("of",f.id),u=(c=f.wrapper.getElementsByTagName("div")).length;u--;)c[u].setAttribute("of",f.id);for(u=(c=f.wrapper.getElementsByTagName("label")).length;u--;)c[u].setAttribute("of",f.id);for(u=(c=f.wrapper.getElementsByTagName("fieldset")).length;u--;)c[u].setAttribute("of",f.id);for(u=(c=f.wrapper.getElementsByTagName("legend")).length;u--;)c[u].setAttribute("of",f.id);for(u=(c=f.wrapper.getElementsByTagName("input")).length;u--;)c[u].setAttribute("of",f.id);for(u=(c=f.wrapper.getElementsByTagName("button")).length;u--;)c[u].setAttribute("of",f.id)}f.note&&(f.wrapper.addEventListener("mouseover",Y.bind(f)),(c="DIV"!==f.e.tagName?f.e:f.e.getElementsByTagName("input")[0])&&(c.addEventListener("focus",Y.bind(f)),c.addEventListener("blur",Q))),"-1"!==f.default&&s.number.test(f.default)&&(f.default=Number(f.default)),Object.hasOwn(l,f.type)&&((c=l[f.type]).init&&c.init(f),f.options="select"===f.type?f.e.children:f.e.getElementsByTagName("input"),c.setter&&(f.set=c.setter.bind(f),f.reset=function(){this.set(X(this.default))}.bind(f)),c.retrieve&&(f.get=c.retrieve.bind(f)),c.adder&&(f.add=c.adder.bind(f)),c.listener&&(f.listen=c.listener.bind(f)),v[f.id]=f)}if(i.variables&&i.variables.length)for(u=i.variables.length;u--;){for(a=i.variables[u].id,v[a]={id:a,type:"virtual",source:i.variables[u].default,previous:void 0,default:i.variables[u].default,current_index:-1,values:[],states:i.variables[u].states,update:function(){this.source=void 0;for(var e,t,i,a=this.states.length;a--;){for(i=this.states[a].condition.length,e=!0;i--;)if(t=this.states[a].condition[i],DataHandler.prototype.checks[t.type](X(t.id),X(t.value))){if(t.any){e=!0;break}}else e=!1;if(e){this.source=this.states[a].value;break}}this.source||(this.source=this.default),this.source!==this.previous?(this.previous=this.source,le(this.id)):Object.hasOwn(v,this.source)&&(t=v[this.source].value())!==this.previous&&(this.previous=t,le(this.id))},value:function(){return X(this.source)},set:function(e){-1!==this.values.indexOf(e)?(this.previous=this.source,this.source=e):Object.hasOwn(v,this.source)&&-1!==v[this.source].values.indexOf(e)&&v[this.source].set(e),le(this.id)}},v[a].source&&v[a].values.push(v[a].source),c={},r=v[a].states.length;r--;)for(v[a].values.push(v[a].states[r].value),m=v[a].states[r].condition.length;m--;)Object.hasOwn(c,v[a].states[r].condition[m].id)||(c[v[a].states[r].condition[m].id]={type:"update",id:a});for(a in c)Object.hasOwn(c,a)&&T(a,c[a])}if(i.rules&&i.rules.length)for(m=i.rules.length;m--;){for(a in i.rules[m].effects)"display"===a&&(i.rules[m].effects[a]={e:t.getElementById(i.rules[m].effects[a])},(d=i.rules[m].effects[a].e.getElementsByClassName("auto-input")).length&&(i.rules[m].effects[a].u=v[d[0].id]));for(u=(d=i.rules[m].condition).length,r=0;r<u;r++)if(Object.hasOwn(DataHandler.prototype.checks,d[r].type))if(d[r].check=function(){return DataHandler.prototype.checks[this.type](X(this.id),X(this.value))}.bind(d[r]),Object.hasOwn(v,d[r].id)&&(T(d[r].id,{type:"rule",id:d[r].id,condition:d[r],rule:m}),Object.hasOwn(b,d[r].id)||(b[d[r].id]={}),b[d[r].id][m]=i.rules[m]),d[r].check())for(a in i.rules[m].effects)Object.hasOwn(v,a)&&v[a].set(X(i.rules[m].effects[a]));else if(d[r].default)for(a in i.rules[m].effects)Object.hasOwn(v,a)&&v[a].set(X(d[r].default))}e.addEventListener("resize",J),i.metadata.datasets||G(),"undefined"!=typeof DataHandler&&(p.dataset=X(i.dataviews[p.dataview].dataset),i.data=new DataHandler(i,p,i.data,{init:W,onload:function(){setTimeout(G,250),J()},data_load:function(){for(var e in g)Object.hasOwn(g,e)&&le(e)}}),i.data.retrievers.vector=i.data.retrievers.vector.bind(i.data),i.query&&(i.parsed_query=i.data.parse_query(i.query))),h.load_screen&&i.data.inited?i.data.inited.load_screen=setTimeout(G,3e3):h.wrap.style.visibility="visible"}};"undefined"==typeof module?e(window,document,site):module.exports=e}();