<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="community"><title>Build a Data Site • community</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Build a Data Site"><meta property="og:description" content="community"><meta property="og:image" content="https://uva-bi-sdad.github.io/community/logo.svg"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">community</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1.200</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/anti-patterns.html">Notes against anti-patterns in Site.R</a>
    <a class="dropdown-item" href="../articles/casestudy-arrests.html">Example - Illinois Arrests</a>
    <a class="dropdown-item" href="../articles/quickstart-site.html">Build a Data Site</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/uva-bi-sdad/community/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Build a Data Site</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/uva-bi-sdad/community/blob/HEAD/vignettes/quickstart-site.Rmd" class="external-link"><code>vignettes/quickstart-site.Rmd</code></a></small>
      <div class="d-none name"><code>quickstart-site.Rmd</code></div>
    </div>

    
    
<p><em>Built with R 4.3.0</em></p>
<hr />
<div id="basic-example" class="section level1">
<h1>Basic example</h1>
<p>Building a data site consists of 3 steps:</p>
<ol style="list-style-type: decimal">
<li>Initialize the site</li>
<li>Add data to the site</li>
<li>Specify the site’s layout</li>
</ol>
<div id="initialize" class="section level2">
<h2>1. Initialize</h2>
<p>Start by loading the library and initializing a site.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(community)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># this can be in an existing or new directory</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># for this example, it is a temporary directory</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>output <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="fu">tempdir</span>(), <span class="st">&quot;/example_site&quot;</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">init_site</span>(output)</span></code></pre></div>
</div>
<div id="add-data" class="section level2">
<h2>2. Add Data</h2>
<p>Now you should have a <code>data</code> folder in <code>output</code>
where you can put your data files, and a <code>build.R</code> file which
you can use to reformat those files if needed, and add them to the
site.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make a simple example set</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">ID =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">78</span>,</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">234</span>), <span class="dv">78</span>, <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="cn">NULL</span>, <span class="fu">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>, <span class="st">&quot;z&quot;</span>)))</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># write that set to a file</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(data, <span class="fu">paste0</span>(output, <span class="st">&quot;/docs/data/data.csv&quot;</span>), <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co"># add it to the site</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="fu">data_add</span>(<span class="fu">paste0</span>(output, <span class="st">&quot;/docs/data/data.csv&quot;</span>))</span></code></pre></div>
<p>This sets up the data’s metadata (written to
<code>datapackage.json</code>), which the site will use when it’s
built.</p>
<p>Including this code in <code>build.R</code> is not necessary, but can
be a way to organize things, and make any data processing steps
repeatable.</p>
<p>Including the original data (<code>data.csv</code> in this case) is
not also strictly necessary – the data file made when you build the site
(by default) is all that will actually be used by the site.</p>
</div>
<div id="specify" class="section level2">
<h2>3. Specify</h2>
<p>Everything to do with the look and functionality of the site happens
between <code>site.R</code> and the <code>site_build</code>
function.</p>
<p>For an initial site, replace the template content of
<code>site.R</code> with this:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">page_navbar</span>(<span class="st">&quot;Site Title&quot;</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">output_plot</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>, <span class="st">&quot;z&quot;</span>)</span></code></pre></div>
<p>Then save and build the site:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">site_build</span>(output, <span class="at">open_after =</span> <span class="cn">TRUE</span>, <span class="at">serve =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><code>open_after</code> opens the build page in a browser, which
might get annoying as you edit and rebuild the site.</p>
<p><code>serve</code> starts a local server to view the page.</p>
</div>
</div>
<div id="add-inputs" class="section level1">
<h1>Add inputs</h1>
<p>Inputs can be named and then referred to in outputs. For example, you
might want to allow plot variables to be changed. To do that, you can
add a select input with variables as options.</p>
<p>Change <code>site.R</code> to this:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">page_navbar</span>(<span class="st">&quot;Site Title&quot;</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">input_select</span>(<span class="st">&quot;X Variable:&quot;</span>, <span class="st">&quot;variables&quot;</span>, <span class="at">default =</span> <span class="st">&quot;x&quot;</span>, <span class="at">id =</span> <span class="st">&quot;selected_x&quot;</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">output_plot</span>(<span class="st">&quot;selected_x&quot;</span>, <span class="st">&quot;y&quot;</span>, <span class="st">&quot;z&quot;</span>)</span></code></pre></div>
<p>Then rebuild:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">site_build</span>(output, <span class="at">open_after =</span> <span class="cn">TRUE</span>, <span class="at">serve =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
</div>
<div id="add-structure" class="section level1">
<h1>Add structure</h1>
<p><code>page_section</code> is the main way to arrange components of
the site, which can be wrapped around any set of input or output
elements.</p>
<p><code>page_menu</code> can be a nice way to arrange inputs.</p>
<p>These can be added to the previous example like this:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">page_navbar</span>(<span class="st">&quot;Site Title&quot;</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">page_menu</span>(</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">input_select</span>(<span class="st">&quot;X Variable:&quot;</span>, <span class="st">&quot;variables&quot;</span>, <span class="at">default =</span> <span class="st">&quot;x&quot;</span>, <span class="at">id =</span> <span class="st">&quot;selected_x&quot;</span>),</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">default_open =</span> <span class="cn">TRUE</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="fu">page_section</span>(</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">wraps =</span> <span class="st">&quot;col&quot;</span>,</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">output_plot</span>(<span class="st">&quot;selected_x&quot;</span>, <span class="st">&quot;y&quot;</span>, <span class="st">&quot;z&quot;</span>)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="add-interactions" class="section level1">
<h1>Add interactions</h1>
<p>Plots (as well as maps) can be the source of mouse events (such as
hovers and clicks). Information panes can respond to these events by
displaying additional information.</p>
<p>For example, we can tie a tooltip-like output to the plot like
this:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">page_navbar</span>(<span class="st">&quot;Site Title&quot;</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">page_menu</span>(</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">input_select</span>(<span class="st">&quot;X Variable:&quot;</span>, <span class="st">&quot;variables&quot;</span>, <span class="at">default =</span> <span class="st">&quot;x&quot;</span>, <span class="at">id =</span> <span class="st">&quot;selected_x&quot;</span>),</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">default_open =</span> <span class="cn">TRUE</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co"># give the plot an ID</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="fu">output_plot</span>(<span class="st">&quot;selected_x&quot;</span>, <span class="st">&quot;y&quot;</span>, <span class="st">&quot;z&quot;</span>, <span class="at">id =</span> <span class="st">&quot;main_plot&quot;</span>)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co"># then make an information output that subscribes to it</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="fu">output_info</span>(<span class="st">&quot;features.name&quot;</span>, <span class="fu">c</span>(</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;variables.short_name&quot;</span> <span class="ot">=</span> <span class="st">&quot;value&quot;</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>), <span class="at">subto =</span> <span class="st">&quot;main_plot&quot;</span>, <span class="at">floating =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>In <code>output_info</code>, <code>features.</code>,
<code>variables.</code>, and <code>data.</code> refer to aspects of the
hovered-over entity. <code>variables.</code> and <code>data.</code> also
implicitly refer to a particular variable – by default, this will be the
variable used for color, but setting the <code>variable</code> argument
can change that (e.g., <code>variable = "x"</code> or
<code>variable = "selected_x"</code>).</p>
<p>You can also add <code>floating = TRUE</code> to make the output pane
more like a tooltip.</p>
</div>
<div id="add-variable-information" class="section level1">
<h1>Add variable information</h1>
<p>The information output can also display additional information about
the variables, which you can fill in when you add the data.</p>
<p>For example, run the same <code>data_add</code> command as before,
but include some information about one of the variables:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data_add</span>(</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste0</span>(output, <span class="st">&quot;/docs/data/data.csv&quot;</span>),</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">variables =</span> <span class="fu">list</span>(</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">z =</span> <span class="fu">list</span>(</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">long_name =</span> <span class="st">&quot;Variable Z&quot;</span>,</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">description =</span> <span class="st">&quot;A random variable, drawn from a normal distribution.&quot;</span>,</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">statement =</span> <span class="st">&quot;{features.name} has a Z value of {value}&quot;</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>Then, you can draw from that in the information output in
<code>site.R</code>:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">page_navbar</span>(<span class="st">&quot;Site Title&quot;</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">page_menu</span>(</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">input_select</span>(<span class="st">&quot;X Variable:&quot;</span>, <span class="st">&quot;variables&quot;</span>, <span class="at">default =</span> <span class="st">&quot;x&quot;</span>, <span class="at">id =</span> <span class="st">&quot;selected_x&quot;</span>),</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">default_open =</span> <span class="cn">TRUE</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="fu">output_plot</span>(<span class="st">&quot;selected_x&quot;</span>, <span class="st">&quot;y&quot;</span>, <span class="st">&quot;z&quot;</span>, <span class="at">id =</span> <span class="st">&quot;main_plot&quot;</span>)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="fu">output_info</span>(<span class="st">&quot;features.name&quot;</span>, <span class="fu">c</span>(</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;variables.long_name&quot;</span> <span class="ot">=</span> <span class="st">&quot;value&quot;</span>,</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;variables.description&quot;</span>,</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;variables.statement&quot;</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>), <span class="at">subto =</span> <span class="st">&quot;main_plot&quot;</span>, <span class="at">floating =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
</div>
<div id="add-a-map" class="section level1">
<h1>Add a Map</h1>
<p>Maps will generally require shapes to be added from a separate,
GeoJSON file. You can use the <code>download_census_shapes</code>
function from the <a
href="https://github.com/uva-bi-sdad/catchment">catchment package</a> to
download shapes for Census regions within the United States.</p>
<p>For example, we might download the shapes of states:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remotes::install_github(&quot;uva-bi-sdad/catchment&quot;)</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(catchment)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># save the state shapes to the distribution directory</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="fu">download_census_shapes</span>(<span class="fu">paste0</span>(output, <span class="st">&quot;/docs&quot;</span>), <span class="at">name =</span> <span class="st">&quot;states&quot;</span>)</span></code></pre></div>
<p>Then add a map to <code>site.R</code> (also subscribing the info pane
to it):</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">page_navbar</span>(<span class="st">&quot;Site Title&quot;</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">page_menu</span>(</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">input_select</span>(<span class="st">&quot;X Variable:&quot;</span>, <span class="st">&quot;variables&quot;</span>, <span class="at">default =</span> <span class="st">&quot;x&quot;</span>, <span class="at">id =</span> <span class="st">&quot;selected_x&quot;</span>),</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">default_open =</span> <span class="cn">TRUE</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="fu">output_plot</span>(<span class="st">&quot;selected_x&quot;</span>, <span class="st">&quot;y&quot;</span>, <span class="st">&quot;z&quot;</span>, <span class="at">id =</span> <span class="st">&quot;main_plot&quot;</span>)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="fu">output_info</span>(<span class="st">&quot;features.name&quot;</span>, <span class="fu">c</span>(</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;variables.long_name&quot;</span> <span class="ot">=</span> <span class="st">&quot;value&quot;</span>,</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;variables.description&quot;</span>,</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;variables.statement&quot;</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>), <span class="at">subto =</span> <span class="fu">c</span>(<span class="st">&quot;main_plot&quot;</span>, <span class="st">&quot;main_map&quot;</span>), <span class="at">floating =</span> <span class="cn">TRUE</span>)</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="fu">output_map</span>(</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">name =</span> <span class="st">&quot;data&quot;</span>, <span class="at">id_property =</span> <span class="st">&quot;GEOID&quot;</span>, <span class="at">url =</span> <span class="fu">paste0</span>(output, <span class="st">&quot;/docs/states.geojson&quot;</span>)),</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">color =</span> <span class="st">&quot;z&quot;</span>, <span class="at">id =</span> <span class="st">&quot;main_map&quot;</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>Because the shapes also had some properties, these were added as
entity features, giving some names.</p>
<p>Here, shapes were loaded in from a local file as part of the build
process, but this same file could also be served and referred to by URL,
in which case it would be loaded in separately. Loading the map shapes
separately means the shapes can be independently cached by the browser,
which can improve load times between sites that use the same make.</p>
</div>
<div id="add-entity-metadata" class="section level1">
<h1>Add Entity Metadata</h1>
<p>The map shapes file added some additional information about entities,
such as their name, but this type of information can be added more
directly through the <code>data_add</code> function’s <code>meta</code>
argument. We’ve already used this argument to add variable metadata with
a list in the <code>variables</code> entry. Similarly, entity metadata
can be added in an <code>ids</code> entry.</p>
<p>For example, you might add names to some of the entries for which
there is no state:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># include the ids list in your call to `data_add`</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data_add</span>(</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste0</span>(output, <span class="st">&quot;/docs/data/data.csv&quot;</span>),</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">variables =</span> <span class="fu">list</span>(</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">z =</span> <span class="fu">list</span>(</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">long_name =</span> <span class="st">&quot;Variable Z&quot;</span>,</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">description =</span> <span class="st">&quot;A random variable, drawn from a normal distribution.&quot;</span>,</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">statement =</span> <span class="st">&quot;{features.name} has a Z value of {value}&quot;</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">ids =</span> <span class="fu">list</span>(</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">variable =</span> <span class="st">&quot;ID&quot;</span>,</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">map =</span> <span class="fu">list</span>(</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;3&quot;</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">name =</span> <span class="st">&quot;No State 3&quot;</span>),</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;7&quot;</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">name =</span> <span class="st">&quot;No State 7&quot;</span>)</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a><span class="co"># then rebuild</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a><span class="fu">site_build</span>(output, <span class="at">open_after =</span> <span class="cn">TRUE</span>, <span class="at">serve =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>Now you should see names for entities 3 and 7.</p>
<p>The <code>ids</code> field might be particularly useful if you
already have metadata like this in a separate file, or plan to use that
information between sites. In that case, you can replace the list in
<code>map</code> with the path to a local file, or a URL to be loaded in
dynamically.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>



    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by <a href="https://biocomplexity.virginia.edu/institute/divisions/social-and-decision-analytics" class="external-link">Biocomplexity Institute</a>, Micah Iserman.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>
